# API é…ç½®ï¼ˆä¸€ï¼‰ä¹‹åº”ç”¨

æœ¬æ–‡åŸºäº Dubbo 2.6.1 ç‰ˆæœ¬ï¼Œæœ›çŸ¥æ‚‰ã€‚
 
å‹æƒ…æç¤ºï¼Œã€**é…ç½®**ã€‘è¿™å—çš„å†…å®¹ï¼Œä¼šç›¸å¯¹æ¯”è¾ƒæ¯ç‡¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœçœ‹åˆ°ä¸€äº›å¾ˆéš¾æ‡‚çš„åœ°æ–¹ï¼Œå»ºè®®å…ˆè·³è¿‡ã€‚

å¯¹äº Dubbo ï¼Œé‡ç‚¹æ˜¯è¦å»ç†è§£ï¼Œå¤šåè®®ã€RPCã€å®¹é”™ç­‰ç­‰æ¨¡å—ï¼Œè€Œä¸æ˜¯ã€**é…ç½®**ã€‘ã€‚

ğŸ˜ˆ ä¼°è®¡å¥½å¤šèƒ–å‹è¢«ã€**é…ç½®**ã€‘è¿™ç« åŠé€€äº†æŠŠï¼Ÿï¼Ÿï¼Ÿ

# 1. æ¦‚è¿°

æˆ‘ä»¬éƒ½â€œçŸ¥é“â€ï¼ŒDubbo çš„é…ç½®æ˜¯éå¸¸â€œçµæ´»â€çš„ã€‚

ä¾‹å¦‚ï¼Œç›®å‰æä¾›äº†å››ç§**é…ç½®æ–¹å¼**ï¼š

1. API é…ç½®
1. å±æ€§é…ç½®
1. XML é…ç½®
1. æ³¨è§£é…ç½®

psï¼šğŸ™‚ åç»­çš„å‡ ç¯‡æ–‡ç« ä¹Ÿæ˜¯æŒ‰ç…§è¿™æ ·çš„é¡ºåºï¼Œè§£æ Dubbo é…ç½®çš„æºç ã€‚

å†ä¾‹å¦‚ï¼Œå¯çµæ´»è®¾ç½®çš„**é…ç½®é¡¹**ï¼š
FROM [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” schema é…ç½®å‚è€ƒæ‰‹å†Œã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/introduction.html)

æ‰€æœ‰é…ç½®é¡¹åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œå‚è§ä¸‹è¡¨ä¸­çš„â€ä½œç”¨â€ä¸€åˆ—ã€‚

* æœåŠ¡å‘ç°ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºæœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œç›®çš„æ˜¯è®©æ¶ˆè´¹æ–¹æ‰¾åˆ°æä¾›æ–¹ã€‚
* æœåŠ¡æ²»ç†ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºæ²»ç†æœåŠ¡é—´çš„å…³ç³»ï¼Œæˆ–ä¸ºå¼€å‘æµ‹è¯•æä¾›ä¾¿åˆ©æ¡ä»¶ã€‚
* æ€§èƒ½è°ƒä¼˜ï¼šè¡¨ç¤ºè¯¥é…ç½®é¡¹ç”¨äºè°ƒä¼˜æ€§èƒ½ï¼Œä¸åŒçš„é€‰é¡¹å¯¹æ€§èƒ½ä¼šäº§ç”Ÿå½±å“ã€‚

æ‰€æœ‰é…ç½®æœ€ç»ˆéƒ½å°†è½¬æ¢ä¸º Dubbo URL è¡¨ç¤ºï¼Œå¹¶ç”±æœåŠ¡æä¾›æ–¹ç”Ÿæˆï¼Œç»æ³¨å†Œä¸­å¿ƒä¼ é€’ç»™æ¶ˆè´¹æ–¹ï¼Œå„å±æ€§å¯¹åº” URL çš„å‚æ•°ï¼Œå‚è§é…ç½®é¡¹ä¸€è§ˆè¡¨ä¸­çš„ â€œå¯¹åº”URLå‚æ•°â€ åˆ—ã€‚

psï¼šğŸ™‚ å¯èƒ½è½¬æ¢æˆ Dubbo [URL](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-common/src/main/java/com/alibaba/dubbo/common/URL.java) ä¸å¤ªå¥½ç†è§£ã€‚è‰¯å¿ƒå¦‚ç¬”è€…ï¼Œåç»­æœ‰æ–‡ç« ä¼šè´¯ä¸²å®ƒã€‚

å½“ç„¶ï¼Œå‡¡äº‹éƒ½æœ‰ä¸¤é¢æ€§ï¼Œåœ¨ç¤¾åŒºé‡Œä¹Ÿå­˜åœ¨å»ºè®®çš„å£°éŸ³ï¼Œä¾‹å¦‚ï¼š[ã€ŠISSUE/#738ï¼šXMLé…ç½®é¡¹é‡æ–°æ¢³ç†ã€‹](https://github.com/alibaba/dubbo/issues/738) ï¼š
ç›®å‰æœ‰ä¸€äº›é…ç½®é¡¹å­˜åœ¨æš´éœ²çš„ä½ç½®ä¸æ­£ç¡®ã€æš´éœ²ä¸å…¨é¢ã€æ–‡æ¡£å’Œå«ä¹‰ä¸åŒ¹é…ç­‰é—®é¢˜ï¼ŒæœŸæœ›åœ¨2.5.7ç‰ˆæœ¬å°†å·²çŸ¥é—®é¢˜äºˆä»¥æ•´ç†ä¿®å¤

**å¦‚æœä½¿ç”¨ä¸­æœ‰é‡åˆ°çš„é…ç½®é—®é¢˜ï¼Œè¯·åœ¨è¯„è®ºä¸­åˆ—å‡ºä»¥ä¾¿æ”¹è¿›**

# 2. é…ç½®ä¸€è§ˆ

æˆ‘ä»¬æ¥çœ‹çœ‹

dubbo-config-api
çš„**é¡¹ç›®ç»“æ„**ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![dubbo-config-api é¡¹ç›®ç»“æ„](http://static2.iocoder.cn/images/Dubbo/2018_01_07/01.png)

ä¸€è„¸æ‡µé€¼ï¼Œå¥½å¤šå•Šã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ•´ç†ä¸‹**é…ç½®ä¹‹é—´çš„å…³ç³»**ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
FROM [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” XML é…ç½®ã€‹](http://dubbo.apache.org/zh-cn/docs/user/configuration/xml.html)
![é…ç½®ä¹‹é—´çš„å…³ç³»](http://static2.iocoder.cn/images/Dubbo/2018_01_07/02.png)

ä»è¿™å¼ å›¾ä¸­ï¼Œå¯ä»¥çœ‹å‡ºåˆ†æˆ**å››ä¸ª**éƒ¨åˆ†ï¼š

1. application-shared
1. provider-side
1. consumer-side
1. sub-config

å®é™…ä¸Šï¼Œä¸Šå›¾å’Œç›®å‰ç‰ˆæœ¬çš„ä»£ç ä¼šå­˜åœ¨ä¸€ç‚¹ç‚¹å‡ºå…¥ï¼Œæˆ‘ä»¬åœ¨çœ‹çœ‹å®é™…çš„**ç±»å…³ç³»**ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![é…ç½®ç±»å…³ç³»](http://static2.iocoder.cn/images/Dubbo/2018_01_07/03.png)

* **çº¢å‹¾**éƒ¨åˆ†ï¼Œapplication-shared ï¼Œåœ¨æœ¬æ–‡è¿›è¡Œåˆ†äº«ã€‚
* **é»„æ¡†**éƒ¨åˆ†ï¼Œprovider-side ï¼Œåœ¨ [ã€ŠAPI é…ç½®ï¼ˆäºŒï¼‰ä¹‹æœåŠ¡æä¾›è€…ã€‹](http://svip.iocoder.cn/Dubbo/configuration-api-2/?self) åˆ†äº«ã€‚
* **çº¢æ¡†**éƒ¨åˆ†ï¼Œconsumer-side ï¼Œåœ¨ [ã€ŠAPI é…ç½®ï¼ˆä¸‰ï¼‰ä¹‹æœåŠ¡æ¶ˆè´¹è€…ã€‹](http://svip.iocoder.cn/Dubbo/configuration-api-3/?self) åˆ†äº«ã€‚
* **å…¶ä»–**éƒ¨åˆ†ï¼Œsub-config ï¼Œåœ¨ [ã€ŠAPI é…ç½®ï¼ˆäºŒï¼‰ä¹‹æœåŠ¡æä¾›è€…ã€‹](http://svip.iocoder.cn/Dubbo/configuration-api-2/?self) åˆ†äº«ã€‚

# 3. Config

æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” API é…ç½®ã€‹](http://dubbo.apache.org/zh-cn/docs/user/configuration/api.html) ï¼Œæä¾›çš„æ¶ˆè´¹è€…çš„åˆå§‹åŒ–ä»£ç ï¼š
```
// å½“å‰åº”ç”¨é…ç½®
ApplicationConfig application = new ApplicationConfig();
application.setName("yyy");
// è¿æ¥æ³¨å†Œä¸­å¿ƒé…ç½®
RegistryConfig registry = new RegistryConfig();
registry.setAddress("10.20.130.230:9090");
registry.setUsername("aaa");
registry.setPassword("bbb");
// æ³¨æ„ï¼šReferenceConfigä¸ºé‡å¯¹è±¡ï¼Œå†…éƒ¨å°è£…äº†ä¸æ³¨å†Œä¸­å¿ƒçš„è¿æ¥ï¼Œä»¥åŠä¸æœåŠ¡æä¾›æ–¹çš„è¿æ¥
// å¼•ç”¨è¿œç¨‹æœåŠ¡
ReferenceConfig<XxxService> reference = new ReferenceConfig<XxxService>(); // æ­¤å®ä¾‹å¾ˆé‡ï¼Œå°è£…äº†ä¸æ³¨å†Œä¸­å¿ƒçš„è¿æ¥ä»¥åŠä¸æä¾›è€…çš„è¿æ¥ï¼Œè¯·è‡ªè¡Œç¼“å­˜ï¼Œå¦åˆ™å¯èƒ½é€ æˆå†…å­˜å’Œè¿æ¥æ³„æ¼
reference.setApplication(application);
reference.setRegistry(registry); // å¤šä¸ªæ³¨å†Œä¸­å¿ƒå¯ä»¥ç”¨setRegistries()
reference.setInterface(XxxService.class);
reference.setVersion("1.0.0");
// å’Œæœ¬åœ°beanä¸€æ ·ä½¿ç”¨xxxService
XxxService xxxService = reference.get(); // æ³¨æ„ï¼šæ­¤ä»£ç†å¯¹è±¡å†…éƒ¨å°è£…äº†æ‰€æœ‰é€šè®¯ç»†èŠ‚ï¼Œå¯¹è±¡è¾ƒé‡ï¼Œè¯·ç¼“å­˜å¤ç”¨
```

* å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºäº† ApplicationConfig å’Œ RegistryConfig å¯¹è±¡ï¼Œè®¾ç½®åˆ° ReferenceConfig å¯¹è±¡ã€‚
* å¦‚æœåˆ›å»º ModuleConfig æˆ– MonitorConfig å¯¹è±¡ï¼Œä¹Ÿæ˜¯å¯ä»¥è®¾ç½®åˆ° ReferenceConfig å¯¹è±¡ä¸­ã€‚

## 3.1 AbstractConfig

[
com.alibaba.dubbo.config.AbstractConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java) ï¼Œ**æŠ½è±¡**é…ç½®ç±»ï¼Œé™¤äº† ArgumentConfig ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„é…ç½®ç±»éƒ½ç»§æ‰¿è¯¥ç±»ã€‚

AbstractConfig ä¸»è¦æä¾›é…ç½®è§£æä¸æ ¡éªŒç›¸å…³çš„å·¥å…·æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬å¼€å§‹çœ‹çœ‹å®ƒçš„ä»£ç ã€‚

[
id
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L110) å±æ€§ï¼Œé…ç½®å¯¹è±¡çš„ç¼–å·ï¼Œé€‚ç”¨äºé™¤äº† API é…ç½®**ä¹‹å¤–**çš„ä¸‰ç§é…ç½®æ–¹å¼ï¼Œæ ‡è®°ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯ç”¨äºå¯¹è±¡ä¹‹é—´çš„å¼•ç”¨ã€‚ä¾‹å¦‚ XML çš„

<dubbo:service provider="${PROVIDER_ID}">
ï¼Œå…¶ä¸­

provider
ä¸º

<dubbo:provider>
çš„ ID å±æ€§ã€‚

é‚£ä¸ºä»€ä¹ˆè¯´ä¸é€‚ç”¨ API é…ç½®å‘¢ï¼Ÿç›´æ¥

/#setXXX(config)
å¯¹è±¡å³å¯ã€‚

é…ç½®é¡¹æ ¡éªŒçš„å·¥å…·æ–¹æ³•ï¼Œä¾‹å¦‚å±æ€§å€¼é•¿åº¦é™åˆ¶ã€æ ¼å¼é™åˆ¶ç­‰ç­‰ï¼Œæ¯”è¾ƒç®€å•ã€‚ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š

* [é™æ€å±æ€§](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L49-L67)
* [é™æ€æ–¹æ³•](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L413-L494)

[
/#appendParameters(parameters, config, prefix)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L244-L313) æ–¹æ³•ï¼Œå°†é…ç½®å¯¹è±¡çš„å±æ€§ï¼Œæ·»åŠ åˆ°å‚æ•°é›†åˆã€‚ä»£ç å¦‚ä¸‹ ï¼š
åœ¨çœ‹å…·ä½“ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ [ã€Œ4. URLã€](http://svip.iocoder.cn/Dubbo/configuration-api-1/) å’Œ [ã€Œ5. @Parameterã€](http://svip.iocoder.cn/Dubbo/configuration-api-1/) ã€‚
  ```
1: protected static void appendParameters(Map<String, String> parameters, Object config, String prefix){
2: if (config == null) {
3: return;
4: }
5: Method[] methods = config.getClass().getMethods();
6: for (Method method : methods) {
7: try {
8: String name = method.getName();
9: if ((name.startsWith("get") || name.startsWith("is"))
10: && !"getClass".equals(name)
11: && Modifier.isPublic(method.getModifiers())
12: && method.getParameterTypes().length == 0
13: && isPrimitive(method.getReturnType())) { // æ–¹æ³•ä¸ºè·å–åŸºæœ¬ç±»å‹ï¼Œpublic çš„ getting æ–¹æ³•ã€‚
14: Parameter parameter = method.getAnnotation(Parameter.class);
15: if (method.getReturnType() == Object.class || parameter != null && parameter.excluded()) {
16: continue;
17: }
18: // è·å¾—å±æ€§å
19: int i = name.startsWith("get") ? 3 : 2;
20: String prop = StringUtils.camelToSplitName(name.substring(i, i + 1).toLowerCase() + name.substring(i + 1), ".");
21: String key;
22: if (parameter != null && parameter.key() != null && parameter.key().length() > 0) {
23: key = parameter.key();
24: } else {
25: key = prop;
26: }
27: // è·å¾—å±æ€§å€¼
28: Object value = method.invoke(config, new Object[0]);
29: String str = String.valueOf(value).trim();
30: if (value != null && str.length() > 0) {
31: // è½¬ä¹‰
32: if (parameter != null && parameter.escaped()) {
33: str = URL.encode(str);
34: }
35: // æ‹¼æ¥ï¼Œè¯¦ç»†è¯´æ˜å‚è§ `Parameter/#append()` æ–¹æ³•çš„è¯´æ˜ã€‚
36: if (parameter != null && parameter.append()) {
37: String pre = parameters.get(Constants.DEFAULT_KEY + "." + key); // default. é‡Œè·å–ï¼Œé€‚ç”¨äº ServiceConfig =ã€‹ProviderConfig ã€ReferenceConfig =ã€‹ConsumerConfig ã€‚
38: if (pre != null && pre.length() > 0) {
39: str = pre + "," + str;
40: }
41: pre = parameters.get(key); // é€šè¿‡ `parameters` å±æ€§é…ç½®ï¼Œä¾‹å¦‚ `AbstractMethodConfig.parameters` ã€‚
42: if (pre != null && pre.length() > 0) {
43: str = pre + "," + str;
44: }
45: }
46: if (prefix != null && prefix.length() > 0) {
47: key = prefix + "." + key;
48: }
49: parameters.put(key, str);
50: // System.out.println("kv:" + key + "\t" + str);
51: } else if (parameter != null && parameter.required()) {
52: throw new IllegalStateException(config.getClass().getSimpleName() + "." + key + " == null");
53: }
54: } else if ("getParameters".equals(name)
55: && Modifier.isPublic(method.getModifiers())
56: && method.getParameterTypes().length == 0
57: && method.getReturnType() == Map.class) { // `/#getParameters()` æ–¹æ³•
58: Map<String, String> map = (Map<String, String>) method.invoke(config, new Object[0]);
59: if (map != null && map.size() > 0) {
60: String pre = (prefix != null && prefix.length() > 0 ? prefix + "." : "");
61: for (Map.Entry<String, String> entry : map.entrySet()) {
62: parameters.put(pre + entry.getKey().replace('-', '.'), entry.getValue());
63: }
64: }
65: }
66: } catch (Exception e) {
67: throw new IllegalStateException(e.getMessage(), e);
68: }
69: }
70: }
```

* parameters
ï¼Œå‚æ•°é›†åˆã€‚å®é™…ä¸Šï¼Œè¯¥é›†åˆä¼šç”¨äº

URL.parameters
ã€‚
* config
ï¼Œé…ç½®å¯¹è±¡ã€‚
* prefix
ï¼Œå±æ€§å‰ç¼€ã€‚ç”¨äºé…ç½®é¡¹æ·»åŠ åˆ°

parameters
ä¸­æ—¶çš„å‰ç¼€ã€‚
* ç¬¬ 5 è¡Œï¼šè·å¾—æ‰€æœ‰æ–¹æ³•çš„æ•°ç»„ï¼Œä¸ºä¸‹é¢é€šè¿‡**åå°„**è·å¾—é…ç½®é¡¹çš„å€¼åšå‡†å¤‡ã€‚
* ç¬¬ 6 è¡Œï¼š**å¾ªç¯**æ¯ä¸ªæ–¹æ³•ã€‚
* ç¬¬ 9 è‡³ 13 è¡Œï¼šæ–¹æ³•ä¸ºè·å¾—**åŸºæœ¬ç±»å‹** +

public
çš„ getting æ–¹æ³•ã€‚

* ç¬¬ 14 è‡³ 17 è¡Œï¼šè¿”å›å€¼ç±»å‹ä¸º Object æˆ–æ’é™¤( [`@Parameter.exclue](mailto:%60@Parameter.exclue)=true` )çš„é…ç½®é¡¹ï¼Œè·³è¿‡ã€‚
* ç¬¬ 19 è‡³ 26 è¡Œï¼šè·å¾—é…ç½®é¡¹**å**ã€‚
* ç¬¬ 28 è‡³ 48 è¡Œï¼šè·å¾—é…ç½®é¡¹**å€¼**ã€‚ä¸­é—´æœ‰ä¸€äº›é€»è¾‘å¤„ç†ï¼Œèƒ–å‹çœ‹ä¸‹ä»£ç çš„æ³¨é‡Šã€‚
* ç¬¬ 49 è¡Œï¼šæ·»åŠ é…ç½®é¡¹åˆ°

parameters
ã€‚
* ç¬¬ 51 è‡³ 53 è¡Œï¼šå½“ [`@Parameter.required](mailto:%60@Parameter.required) = true` æ—¶ï¼Œæ ¡éªŒé…ç½®é¡¹éç©ºã€‚
* ç¬¬ 54 è‡³ 57 è¡Œï¼šå½“æ–¹æ³•ä¸º

/#getParameters()
æ—¶ï¼Œ[ä¾‹å¦‚](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/ApplicationConfig.java#L253-L255) ã€‚

* ç¬¬ 58 è¡Œï¼šé€šè¿‡åå°„ï¼Œè·å¾—

/#getParameters()
çš„è¿”å›å€¼ä¸º

map
ã€‚
* ç¬¬ 59 è‡³ 64 è¡Œï¼šå°†

map
æ·»åŠ åˆ°

parameters
ï¼Œkv æ ¼å¼ä¸º

prefix:entry.key

entry.value
ã€‚
* å› æ­¤ï¼Œé€šè¿‡

/#getParameters()
å¯¹åº”çš„å±æ€§ï¼Œ**åŠ¨æ€è®¾ç½®é…ç½®é¡¹ï¼Œæ‹“å±•å‡ºé Dubbo å†…ç½®å¥½çš„é€»è¾‘**ã€‚

[
/#appendAttributes(parameters, config, prefix)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L326-L363) æ–¹æ³•ï¼Œå°†

@Parameter(attribute = true)
é…ç½®å¯¹è±¡çš„å±æ€§ï¼Œæ·»åŠ åˆ°å‚æ•°é›†åˆã€‚ä»£ç å¦‚ä¸‹ï¼š
```
1: protected static void appendAttributes(Map<Object, Object> parameters, Object config, String prefix){
2: if (config == null) {
3: return;
4: }
5: Method[] methods = config.getClass().getMethods();
6: for (Method method : methods) {
7: try {
8: String name = method.getName();
9: if ((name.startsWith("get") || name.startsWith("is"))
10: && !"getClass".equals(name)
11: && Modifier.isPublic(method.getModifiers())
12: && method.getParameterTypes().length == 0
13: && isPrimitive(method.getReturnType())) { // æ–¹æ³•ä¸ºè·å–åŸºæœ¬ç±»å‹ï¼Œpublic çš„ getting æ–¹æ³•ã€‚
14: Parameter parameter = method.getAnnotation(Parameter.class);
15: if (parameter == null || !parameter.attribute())
16: continue;
17: // è·å¾—å±æ€§å
18: String key;
19: if (parameter != null && parameter.key() != null && parameter.key().length() > 0) {
20: key = parameter.key();
21: } else {
22: int i = name.startsWith("get") ? 3 : 2;
23: key = name.substring(i, i + 1).toLowerCase() + name.substring(i + 1);
24: }
25: // è·å¾—å±æ€§å€¼ï¼Œå­˜åœ¨åˆ™æ·»åŠ åˆ° `parameters` é›†åˆ
26: Object value = method.invoke(config, new Object[0]);
27: if (value != null) {
28: if (prefix != null && prefix.length() > 0) {
29: key = prefix + "." + key;
30: }
31: parameters.put(key, value);
32: }
33: }
34: } catch (Exception e) {
35: throw new IllegalStateException(e.getMessage(), e);
36: }
37: }
38: }
```

* ä¸åŒäº [
/#appendAttributes(parameters, config, prefix)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L326-L363) æ–¹æ³•ï¼Œä¸»è¦ç”¨äº [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” äº‹ä»¶é€šçŸ¥ã€‹](http://dubbo.apache.org/zh-cn/docs/user/demos/events-notify.html) ï¼Œæ³¨è§£

@Parameter(attribute = true)
çš„å±æ€§å¦‚ä¸‹å›¾ï¼š![@Parameter(attribute = true)](http://static2.iocoder.cn/images/Dubbo/2018_01_07/05.png)
* ç¬¬ 9 è‡³ 13 è¡Œï¼šæ–¹æ³•ä¸ºè·å¾—**åŸºæœ¬ç±»å‹** +

public
çš„ getting æ–¹æ³•ã€‚
* ç¬¬ 14 è‡³ 16 è¡Œï¼š**éœ€è¦**( [`@Parameter.exclue](mailto:%60@Parameter.exclue)=true` )çš„é…ç½®é¡¹ã€‚
* ç¬¬ 17 è‡³ 24 è¡Œï¼šè·å¾—é…ç½®é¡¹**å**ã€‚
* ç¬¬ 26 è‡³ 30 è¡Œï¼šè·å¾—é…ç½®é¡¹**å€¼**ã€‚
* ç¬¬ 31 è¡Œï¼šæ·»åŠ é…ç½®é¡¹åˆ°

parameters
ã€‚

[
/#appendProperties(config)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L139-L212) æ–¹æ³•ï¼Œè¯»å–ç¯å¢ƒå˜é‡å’Œ properties é…ç½®åˆ°é…ç½®å¯¹è±¡ã€‚åœ¨ [ã€Šç²¾è¿› Dubbo æºç è§£æ â€”â€” å±æ€§é…ç½®ã€‹](http://svip.iocoder.cn/Dubbo/configuration-properties/?self) è¯¦ç»†è§£æã€‚

[
/#appendAnnotation(annotationClass, annotation)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L505-L541) æ–¹æ³•ï¼Œè¯»å–æ³¨è§£é…ç½®åˆ°é…ç½®å¯¹è±¡ã€‚åœ¨ [ã€Šç²¾è¿› Dubbo æºç è§£æ â€”â€” æ³¨è§£é…ç½®ã€‹](http://svip.iocoder.cn/Dubbo/configuration-api-1/TODO) è¯¦ç»†è§£æã€‚

## 3.2 ApplicationConfig

[
com.alibaba.dubbo.config.ApplicationConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/ApplicationConfig.java) ï¼Œåº”ç”¨é…ç½®ã€‚

* å…·ä½“å±æ€§çš„è§£é‡Šï¼Œå‚è§ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” dubbo:applicationã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-application.html) æ–‡æ¡£ã€‚

## 3.3 RegistryConfig

[
com.alibaba.dubbo.config.RegistryConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/RegistryConfig.java) ï¼Œæ³¨å†Œä¸­å¿ƒé…ç½®ã€‚

* å…·ä½“å±æ€§çš„è§£é‡Šï¼Œå‚è§ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” dubbo:registryã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-registry.html) æ–‡æ¡£ã€‚

## 3.4 ModuleConfig

[
com.alibaba.dubbo.config.ModuleConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/ModuleConfig.java) ï¼Œæ¨¡å—ä¿¡æ¯é…ç½®ã€‚

* å…·ä½“å±æ€§çš„è§£é‡Šï¼Œå‚è§ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” dubbo:moduleã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-module.html) æ–‡æ¡£ã€‚

## 3.5 MonitorConfig

[
com.alibaba.dubbo.config.MonitorConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/MonitorConfig.java) ï¼Œç›‘æ§ä¸­å¿ƒé…ç½®ã€‚

* å…·ä½“å±æ€§çš„è§£é‡Šï¼Œå‚è§ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” dubbo:monitorã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-monitor.html) æ–‡æ¡£ã€‚

## 3.6 ArgumentConfig

[
com.alibaba.dubbo.config.ArgumentConfig
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/ArgumentConfig.java) ï¼Œæ–¹æ³•å‚æ•°é…ç½®ã€‚

* å…·ä½“å±æ€§çš„è§£é‡Šï¼Œå‚è§ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” dubbo:argumentã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-argument.html) æ–‡æ¡£ã€‚
* è¯¥é…ç½®ç±»è®¾ç½®åˆ° MethodConfig å¯¹è±¡ä¸­ï¼Œåœ¨ [ã€ŠAPI é…ç½®ï¼ˆäºŒï¼‰ä¹‹æœåŠ¡æä¾›è€…ã€‹](http://svip.iocoder.cn/Dubbo/configuration-api-2/?self) æˆ‘ä»¬ä¼šçœ‹åˆ°ã€‚
* åœ¨ [ã€ŠDubbo ç”¨æˆ·æŒ‡å— â€”â€” å‚æ•°å›è°ƒã€‹](http://dubbo.apache.org/zh-cn/docs/user/demos/callback-parameter.html) ç‰¹æ€§ä¸­ä½¿ç”¨ã€‚

# 4. URL

[
com.alibaba.dubbo.common.URL
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-common/src/main/java/com/alibaba/dubbo/common/URL.java) ï¼ŒDubbo URL ã€‚ä»£ç å¦‚ä¸‹ï¼š
```
public final class URL implements Serializable{
//*/*
/* åè®®å
/*/
private final String protocol;
//*/*
/* ç”¨æˆ·å
/*/
private final String username;
//*/*
/* å¯†ç 
/*/
private final String password;
//*/*
/* by default, host to registry
/* åœ°å€
/*/
private final String host;
//*/*
/* by default, port to registry
/* ç«¯å£
/*/
private final int port;
//*/*
/* è·¯å¾„ï¼ˆæœåŠ¡åï¼‰
/*/
private final String path;
//*/*
/* å‚æ•°é›†åˆ
/*/
private final Map<String, String> parameters;
// ... çœç•¥å…¶ä»–ä»£ç 
}
```

* ä¸Šæ–‡æˆ‘ä»¬æåˆ°**æ‰€æœ‰é…ç½®æœ€ç»ˆéƒ½å°†è½¬æ¢ä¸º Dubbo URL è¡¨ç¤ºï¼Œå¹¶ç”±æœåŠ¡æä¾›æ–¹ç”Ÿæˆï¼Œç»æ³¨å†Œä¸­å¿ƒä¼ é€’ç»™æ¶ˆè´¹æ–¹ï¼Œå„å±æ€§å¯¹åº” URL çš„å‚æ•°ï¼Œå‚è§é…ç½®é¡¹ä¸€è§ˆè¡¨ä¸­çš„ â€œå¯¹åº”URLå‚æ•°â€ åˆ—**ã€‚é‚£ä¹ˆä¸€ä¸ª Service æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒçš„æ ¼å¼å¦‚ä¸‹ï¼š
```
dubbo://192.168.3.17:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&default.delay=-1&default.retries=0&default.service.filter=demoFilter&delay=-1&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=19031&side=provider&timestamp=1519651641799
```

* æ ¼å¼ä¸º

protocol://username:password@host:port/path?key=value&key=value
ï¼Œé€šè¿‡ [
URL/#buildString(...)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-common/src/main/java/com/alibaba/dubbo/common/URL.java#L1176-L1217) æ–¹æ³•ç”Ÿæˆã€‚
* parameters
å±æ€§ï¼Œå‚æ•°é›†åˆã€‚ä»ä¸Šé¢çš„ Service URL ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢çš„

key=value
ï¼Œå®é™…ä¸Šå°±æ˜¯ Service å¯¹åº”çš„é…ç½®é¡¹ã€‚è¯¥å±æ€§ï¼Œé€šè¿‡ [
AbstractConfig/#appendParameters(parameters, config, prefix)
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/AbstractConfig.java#L244-L313) æ–¹æ³•ç”Ÿæˆã€‚
* ğŸ™‚ åœ¨åç»­çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç° URL ä½œä¸ºä¸€ä¸ª**é€šç”¨æ¨¡å‹**ï¼Œè´¯ç©¿æ•´ä¸ª RPC æµç¨‹ã€‚

# 5. @Parameter

[
com.alibaba.dubbo.config.support.@Parameter
](https://github.com/YunaiV/dubbo/blob/9d38b6f9f95798755141d6140e311e8fd51fecc1/dubbo-config/dubbo-config-api/src/main/java/com/alibaba/dubbo/config/support/Parameter.java) ï¼ŒParameter å‚æ•°**æ³¨è§£**ï¼Œç”¨äº Dubbo URL çš„

parameters
æ‹¼æ¥ã€‚

åœ¨é…ç½®å¯¹è±¡çš„ getting æ–¹æ³•ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥æ³¨è§£çš„ä½¿ç”¨ï¼Œä¾‹å¦‚ä¸‹å›¾ï¼š

![@Parameter ä½¿ç”¨åœºæ™¯](http://static2.iocoder.cn/images/Dubbo/2018_01_07/04.png)

@Parameter ä»£ç å¦‚ä¸‹ï¼š
```
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.METHOD})
public @interface Parameter {
//*/*
/* é”®ï¼ˆåˆ«åï¼‰
/*/
String key() default "";
//*/*
/* æ˜¯å¦å¿…å¡«
/*/
boolean required() default false;
//*/*
/* æ˜¯å¦å¿½ç•¥
/*/
boolean excluded() default false;
//*/*
/* æ˜¯å¦è½¬ä¹‰
/*/
boolean escaped() default false;
//*/*
/* æ˜¯å¦ä¸ºå±æ€§
/*
/* ç›®å‰ç”¨äºã€Šäº‹ä»¶é€šçŸ¥ã€‹http://dubbo.apache.org/zh-cn/docs/user/demos/events-notify.html
/*/
boolean attribute() default false;
//*/*
/* æ˜¯å¦æ‹¼æ¥é»˜è®¤å±æ€§ï¼Œå‚è§ {@link com.alibaba.dubbo.config.AbstractConfig/#appendParameters(Map, Object, String)} æ–¹æ³•ã€‚
/*
/* æˆ‘ä»¬æ¥çœ‹çœ‹ `/#append() = true` çš„å±æ€§ï¼Œæœ‰å¦‚ä¸‹å››ä¸ªï¼š
/* + {@link AbstractInterfaceConfig/#getFilter()}
/* + {@link AbstractInterfaceConfig/#getListener()}
/* + {@link AbstractReferenceConfig/#getFilter()}
/* + {@link AbstractReferenceConfig/#getListener()}
/* + {@link AbstractServiceConfig/#getFilter()}
/* + {@link AbstractServiceConfig/#getListener()}
/* é‚£ä¹ˆï¼Œä»¥ AbstractServiceConfig ä¸¾ä¾‹å­ã€‚
/*
/* æˆ‘ä»¬çŸ¥é“ ProviderConfig å’Œ ServiceConfig ç»§æ‰¿ AbstractServiceConfig ç±»ï¼Œé‚£ä¹ˆ `filter` , `listener` å¯¹åº”çš„ç›¸åŒçš„é”®ã€‚
/* ä¸‹é¢æˆ‘ä»¬ä»¥ `filter` ä¸¾ä¾‹å­ã€‚
/*
/* åœ¨ ServiceConfig ä¸­ï¼Œé»˜è®¤ä¼š<b>ç»§æ‰¿</b> ProviderConfig é…ç½®çš„ `filter` å’Œ `listener` ã€‚
/* æ‰€ä»¥è¿™ä¸ªå±æ€§ï¼Œå°±æ˜¯ç”¨äºï¼Œåƒ ServiceConfig çš„è¿™ç§æƒ…å†µï¼Œä» ProviderConfig è¯»å–çˆ¶å±æ€§ã€‚
/*
/* ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ `ProviderConfig.filter=aaaFilter` ï¼Œ`ServiceConfig.filter=bbbFilter` ï¼Œæœ€ç»ˆæš´éœ²åˆ° Dubbo URL æ—¶ï¼Œå‚æ•°ä¸º `service.filter=aaaFilter,bbbFilter` ã€‚
/*/
boolean append() default false;
```

* èƒ–å‹å¯ä»¥ç®€å•çœ‹ä¸‹ä»£ç ä¸­çš„**æ³¨é‡Š**ï¼Œç»“åˆå…·ä½“ä½¿ç”¨çš„æ–¹æ³•ï¼Œåœ¨ç»†ç»†ç†è§£ã€‚