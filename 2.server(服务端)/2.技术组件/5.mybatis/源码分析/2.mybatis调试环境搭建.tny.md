<div class="article-inner">

<header class="article-header">


<h1 class="article-title" itemprop="name">
ç²¾å°½ MyBatis æºç åˆ†æ â€”â€” è°ƒè¯•ç¯å¢ƒæ­å»º
</h1>



<a href="/MyBatis/build-debugging-environment/" class="archive-article-date">
<time style="display: none;" datetime="2019-12-31T16:00:00.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-01-01</time>
</a>

</header>

<div class="article-entry" itemprop="articleBody">

<h1 id="1-ä¾èµ–å·¥å…·"><a href="#1-ä¾èµ–å·¥å…·" class="headerlink" title="1. ä¾èµ–å·¥å…·"></a>1. ä¾èµ–å·¥å…·</h1><ul>
<li>Maven</li>
<li>Git</li>
<li>JDK</li>
<li>IntelliJ IDEA</li>
</ul>
<h1 id="2-æºç æ‹‰å–"><a href="#2-æºç æ‹‰å–" class="headerlink" title="2. æºç æ‹‰å–"></a>2. æºç æ‹‰å–</h1><p>ä»å®˜æ–¹ä»“åº“ <a href="https://github.com/mybatis/mybatis-3" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/mybatis/mybatis-3</a> <code>Fork</code> å‡ºå±äºè‡ªå·±çš„ä»“åº“ã€‚ä¸ºä»€ä¹ˆè¦ <code>Fork</code> ï¼Ÿæ—¢ç„¶å¼€å§‹é˜…è¯»ã€è°ƒè¯•æºç ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™ä¸€äº›æ³¨é‡Šï¼Œæœ‰äº†è‡ªå·±çš„ä»“åº“ï¼Œå¯ä»¥è¿›è¡Œè‡ªç”±çš„æäº¤ã€‚ğŸ˜ˆ</p>
<p>ä½¿ç”¨ <code>IntelliJ IDEA</code> ä» <code>Fork</code> å‡ºæ¥çš„ä»“åº“æ‹‰å–ä»£ç ã€‚</p>
<p>æœ¬æ–‡ä½¿ç”¨çš„ MyBatis ç‰ˆæœ¬ä¸º <code>3.5.0-SNAPSHOT</code> ã€‚</p>
<p>å› ä¸º MyBatis æ˜¯æœ‰äº›å¹´ä»½çš„æ¡†æ¶ï¼Œæ‰€ä»¥å…‹éš†çš„è¿‡ç¨‹å¯èƒ½æ¯”è¾ƒæ…¢ï¼Œè€å¿ƒç­‰å¾…ã€‚</p>
<h1 id="3-è°ƒè¯•"><a href="#3-è°ƒè¯•" class="headerlink" title="3. è°ƒè¯•"></a>3. è°ƒè¯•</h1><p>MyBatis æƒ³è¦è°ƒè¯•ï¼Œéå¸¸æ–¹ä¾¿ï¼Œåªéœ€è¦æ‰“å¼€ <code>org.apache.ibatis.autoconstructor.AutoConstructorTest</code> å•å…ƒæµ‹è¯•ç±»ï¼Œä»»æ„ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œå³é”®ï¼Œå¼€å§‹è°ƒè¯•å³å¯ã€‚</p>
<p>å½“ç„¶ï¼Œè€ƒè™‘åˆ°è®©å¤§å®¶æ›´å¥½çš„ç†è§£ AutoConstructorTest è¿™ä¸ªç±»ï¼Œä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¯¦ç»†è§£æä¸‹ã€‚AutoConstructorTest æ‰€åœ¨åœ¨ <code>autoconstructor</code> åŒ…ä¸‹ï¼Œæ•´ä½“ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="http://static2.iocoder.cn/images/MyBatis/2020_01_01/01.jpg" alt="åŒ…ç»“æ„å›¾"></p>
<h1 id="4-mybatis-config-xml"><a href="#4-mybatis-config-xml" class="headerlink" title="4. mybatis-config.xml"></a>4. mybatis-config.xml</h1><p><code>mybatis-config.xml</code> ï¼ŒMyBatis é…ç½®æ–‡ä»¶ã€‚XML å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- autoMappingBehavior should be set in each test case --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç† --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®æ•°æ®æº  --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"UNPOOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"org.hsqldb.jdbcDriver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:hsqldb:mem:automapping"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"sa"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ‰«æ Mapper æ–‡ä»¶  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"org/apache/ibatis/autoconstructor/AutoConstructorMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åœ¨ <code>&lt;environments /&gt;</code> æ ‡ç­¾ä¸­ï¼Œé…ç½®äº†äº‹åŠ¡ç®¡ç†å’Œæ•°æ®æºã€‚è€ƒè™‘åˆ°å‡å°‘å¤–éƒ¨ä¾èµ–ï¼Œæ‰€ä»¥ä½¿ç”¨äº† <a href="https://zh.wikipedia.org/wiki/HSQLDB" rel="external nofollow noopener noreferrer" target="_blank">HSQLDB</a> ã€‚</li>
<li>åœ¨ <code>&lt;mappers /&gt;</code> æ ‡ç­¾ä¸­ï¼Œé…ç½®äº†éœ€è¦æ‰«æçš„ Mapper æ–‡ä»¶ã€‚ç›®å‰ï¼Œä»…ä»…æ‰«æ <code>AutoConstructorMapper.xml</code> æ–‡ä»¶ã€‚</li>
</ul>
<h1 id="5-AutoConstructorMapper-xml"><a href="#5-AutoConstructorMapper-xml" class="headerlink" title="5. AutoConstructorMapper.xml"></a>5. AutoConstructorMapper.xml</h1><p><code>AutoConstructorMapper.xml</code> ï¼ŒMapper æ–‡ä»¶ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"org.apache.ibatis.autoconstructor.AutoConstructorMapper"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹åº”çš„æ¥å£ä¸º <code>org.apache.ibatis.autoconstructor.AutoConstructorMapper</code> ã€‚</li>
</ul>
<h2 id="5-1-AutoConstructorMapper"><a href="#5-1-AutoConstructorMapper" class="headerlink" title="5.1 AutoConstructorMapper"></a>5.1 AutoConstructorMapper</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AutoConstructorMapper</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ========== PrimitiveSubject ==========</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM subject WHERE id = #{id}"</span>)</span><br><span class="line">    <span class="function">PrimitiveSubject <span class="title">getSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM subject"</span>)</span><br><span class="line">    <span class="function">List&lt;PrimitiveSubject&gt; <span class="title">getSubjects</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ========== AnnotatedSubject ==========</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM subject"</span>)</span><br><span class="line">    <span class="function">List&lt;AnnotatedSubject&gt; <span class="title">getAnnotatedSubjects</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ========== BadSubject ==========</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM subject"</span>)</span><br><span class="line">    <span class="function">List&lt;BadSubject&gt; <span class="title">getBadSubjects</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ========== ExtensiveSubject ==========</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM extensive_subject"</span>)</span><br><span class="line">    <span class="function">List&lt;ExtensiveSubject&gt; <span class="title">getExtensiveSubject</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä½¿ç”¨æ³¨è§£çš„æ–¹æ³•ï¼Œç¼–å†™ SQL ã€‚</li>
</ul>
<h1 id="6-CreateDB-sql"><a href="#6-CreateDB-sql" class="headerlink" title="6. CreateDB.sql"></a>6. CreateDB.sql</h1><p><code>CreateDB.sql</code> æ–‡ä»¶ï¼Œç”¨äºå•å…ƒæµ‹è¯•é‡Œï¼Œåˆå§‹åŒ–æ•°æ®åº“çš„æ•°æ®ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> subject</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">EXISTS</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> extensive_subject</span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">EXISTS</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> subject (</span><br><span class="line">  <span class="keyword">id</span>     <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="keyword">name</span>   <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">  age    <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  height <span class="built_in">INT</span>,</span><br><span class="line">  weight <span class="built_in">INT</span>,</span><br><span class="line">  active <span class="built_in">BIT</span>,</span><br><span class="line">  dt     <span class="keyword">TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> extensive_subject (</span><br><span class="line">  aByte      TINYINT,</span><br><span class="line">  aShort     <span class="built_in">SMALLINT</span>,</span><br><span class="line">  aChar      <span class="built_in">CHAR</span>,</span><br><span class="line">  anInt      <span class="built_in">INT</span>,</span><br><span class="line">  aLong      <span class="built_in">BIGINT</span>,</span><br><span class="line">  aFloat     <span class="built_in">FLOAT</span>,</span><br><span class="line">  aDouble    <span class="keyword">DOUBLE</span>,</span><br><span class="line">  aBoolean   <span class="built_in">BIT</span>,</span><br><span class="line">  aString    <span class="built_in">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">  anEnum     <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  aClob      LONGVARCHAR,</span><br><span class="line">  aBlob      LONGVARBINARY,</span><br><span class="line">  aTimestamp <span class="keyword">TIMESTAMP</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> subject <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="string">'a'</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="keyword">CURRENT_TIMESTAMP</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="string">'b'</span>, <span class="number">10</span>, <span class="literal">NULL</span>, <span class="number">45</span>, <span class="number">1</span>, <span class="keyword">CURRENT_TIMESTAMP</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="string">'c'</span>, <span class="number">10</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="keyword">CURRENT_TIMESTAMP</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> extensive_subject</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="number">1</span>, <span class="string">'a'</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1.0</span>, <span class="number">1</span>, <span class="string">'a'</span>, <span class="string">'AVALUE'</span>, <span class="string">'ACLOB'</span>, <span class="string">'aaaaaabbbbbb'</span>, <span class="keyword">CURRENT_TIMESTAMP</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">2</span>, <span class="string">'b'</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2.0</span>, <span class="number">2</span>, <span class="string">'b'</span>, <span class="string">'BVALUE'</span>, <span class="string">'BCLOB'</span>, <span class="string">'010101010101'</span>, <span class="keyword">CURRENT_TIMESTAMP</span>),</span><br><span class="line">  (<span class="number">3</span>, <span class="number">3</span>, <span class="string">'c'</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3.0</span>, <span class="number">3</span>, <span class="string">'c'</span>, <span class="string">'CVALUE'</span>, <span class="string">'CCLOB'</span>, <span class="string">'777d010078da'</span>, <span class="keyword">CURRENT_TIMESTAMP</span>);</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åˆ›å»ºäº† <code>subject</code> è¡¨ï¼Œå¹¶åˆå§‹åŒ–ä¸‰æ¡æ•°æ®ã€‚</li>
<li>åˆ›å»ºäº† <code>extensive_subject</code> è¡¨ï¼Œå¹¶åˆå§‹åŒ–ä¸‰æ¡æ•°æ®ã€‚</li>
</ul>
<h1 id="7-POJO"><a href="#7-POJO" class="headerlink" title="7. POJO"></a>7. POJO</h1><p>åœ¨ AutoConstructorMapper ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å››ä¸ª POJO ç±»ã€‚ä½†æ˜¯ï¼Œä» <code>CreateDB.sql</code> ä¸­ï¼Œå®é™…åªæœ‰ä¸¤ä¸ªè¡¨ã€‚è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç»§ç»­å¾€ä¸‹çœ‹å™¢ã€‚</p>
<h2 id="7-1-AnnotatedSubject"><a href="#7-1-AnnotatedSubject" class="headerlink" title="7.1 AnnotatedSubject"></a>7.1 AnnotatedSubject</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.ibatis.autoconstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.AutomapConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotatedSubject</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> weight;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AnnotatedSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> id, <span class="keyword">final</span> String name, <span class="keyword">final</span> <span class="keyword">int</span> age, <span class="keyword">final</span> <span class="keyword">int</span> height, <span class="keyword">final</span> <span class="keyword">int</span> weight)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">        <span class="keyword">this</span>.weight = weight;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AutomapConstructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AnnotatedSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> id, <span class="keyword">final</span> String name, <span class="keyword">final</span> <span class="keyword">int</span> age, <span class="keyword">final</span> Integer height, <span class="keyword">final</span> Integer weight)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.height = height == <span class="keyword">null</span> ? <span class="number">0</span> : height;</span><br><span class="line">        <span class="keyword">this</span>.weight = weight == <span class="keyword">null</span> ? <span class="number">0</span> : weight;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹åº” <code>subject</code> è¡¨ã€‚</li>
<li><code>@AutomapConstructor</code> æ³¨è§£ï¼Œè¡¨ç¤º MyBatis æŸ¥è¯¢åï¼Œåœ¨åˆ›å»º AnnotatedSubject å¯¹è±¡ï¼Œä½¿ç”¨è¯¥æ„é€ æ–¹æ³•ã€‚<ul>
<li>ğŸ˜ˆ å®é™…åœºæ™¯ä¸‹ï¼Œéå¸¸å°‘ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œç”šè‡³ Google ä¸Šèµ„æ–™ä¹Ÿä¸å¤šã€‚</li>
</ul>
</li>
</ul>
<h3 id="7-1-1-PrimitiveSubject"><a href="#7-1-1-PrimitiveSubject" class="headerlink" title="7.1.1 PrimitiveSubject"></a>7.1.1 PrimitiveSubject</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.ibatis.autoconstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimitiveSubject</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> weight;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> active;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Date dt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrimitiveSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> id, <span class="keyword">final</span> String name, <span class="keyword">final</span> <span class="keyword">int</span> age, <span class="keyword">final</span> <span class="keyword">int</span> height, <span class="keyword">final</span> <span class="keyword">int</span> weight, <span class="keyword">final</span> <span class="keyword">boolean</span> active, <span class="keyword">final</span> Date dt)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">        <span class="keyword">this</span>.weight = weight;</span><br><span class="line">        <span class="keyword">this</span>.active = active;</span><br><span class="line">        <span class="keyword">this</span>.dt = dt;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹åº”çš„ä¹Ÿæ˜¯ <code>subject</code> è¡¨ã€‚</li>
<li>å’Œ AnnotatedSubject ä¸åŒï¼Œåœ¨å…¶æ„é€ æ–¹æ³•ä¸Šï¼Œ<code>weight</code> å’Œ <code>height</code> æ–¹æ³•å‚æ•°çš„ç±»å‹æ˜¯ <code>int</code> ï¼Œè€Œä¸æ˜¯ Integer ã€‚é‚£ä¹ˆï¼Œå¦‚æœ <code>subject</code> è¡¨ä¸­çš„è®°å½•ï¼Œè¿™ä¸¤ä¸ªå­—æ®µä¸º <code>NULL</code> æ—¶ï¼Œä¼šåˆ›å»º PrimitiveSubject å¯¹è±¡æŠ¥é”™ã€‚</li>
</ul>
<h3 id="7-1-2-BadSubject"><a href="#7-1-2-BadSubject" class="headerlink" title="7.1.2 BadSubject"></a>7.1.2 BadSubject</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.ibatis.autoconstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BadSubject</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Height height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Double weight;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BadSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> id, <span class="keyword">final</span> String name, <span class="keyword">final</span> <span class="keyword">int</span> age, <span class="keyword">final</span> Height height, <span class="keyword">final</span> Double weight)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">        <span class="keyword">this</span>.weight = weight == <span class="keyword">null</span> ? <span class="number">0</span> : weight;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Height</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹åº”çš„ä¹Ÿæ˜¯ <code>subject</code> è¡¨ã€‚</li>
<li>å’Œ AnnotatedSubject ä¸åŒï¼Œåœ¨å…¶æ„é€ æ–¹æ³•ä¸Šï¼Œ<code>height</code> æ–¹æ³•å‚æ•°çš„ç±»å‹æ˜¯ Height ï¼Œè€Œä¸æ˜¯ Integer ã€‚å› ä¸º MyBatis æ— æ³•è¯†åˆ« Height ç±»ï¼Œæ‰€ä»¥ä¼šåˆ›å»º BadSubject å¯¹è±¡æŠ¥é”™ã€‚</li>
</ul>
<blockquote>
<p>è€è‰¿è‰¿ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒPOJO å¯¹è±¡é‡Œï¼Œä¸ä½¿ç”¨åŸºæœ¬ç±»å‹ã€‚</p>
</blockquote>
<h2 id="7-2-ExtensiveSubject"><a href="#7-2-ExtensiveSubject" class="headerlink" title="7.2 ExtensiveSubject"></a>7.2 ExtensiveSubject</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.apache.ibatis.autoconstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtensiveSubject</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">byte</span> aByte;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">short</span> aShort;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> aChar;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> anInt;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> aLong;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">float</span> aFloat;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> aDouble;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> aBoolean;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String aString;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// enum types</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TestEnum anEnum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// array types</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// string to lob types:</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String aClob;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String aBlob;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExtensiveSubject</span><span class="params">(<span class="keyword">final</span> <span class="keyword">byte</span> aByte,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">short</span> aShort,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">char</span> aChar,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">int</span> anInt,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">long</span> aLong,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">float</span> aFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">double</span> aDouble,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> <span class="keyword">boolean</span> aBoolean,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> String aString,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> TestEnum anEnum,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> String aClob,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">final</span> String aBlob)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.aByte = aByte;</span><br><span class="line">        <span class="keyword">this</span>.aShort = aShort;</span><br><span class="line">        <span class="keyword">this</span>.aChar = aChar;</span><br><span class="line">        <span class="keyword">this</span>.anInt = anInt;</span><br><span class="line">        <span class="keyword">this</span>.aLong = aLong;</span><br><span class="line">        <span class="keyword">this</span>.aFloat = aFloat;</span><br><span class="line">        <span class="keyword">this</span>.aDouble = aDouble;</span><br><span class="line">        <span class="keyword">this</span>.aBoolean = aBoolean;</span><br><span class="line">        <span class="keyword">this</span>.aString = aString;</span><br><span class="line">        <span class="keyword">this</span>.anEnum = anEnum;</span><br><span class="line">        <span class="keyword">this</span>.aClob = aClob;</span><br><span class="line">        <span class="keyword">this</span>.aBlob = aBlob;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> TestEnum {</span><br><span class="line">        AVALUE, BVALUE, CVALUE;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹åº”çš„ä¹Ÿæ˜¯ <code>extensive_subject</code> è¡¨ã€‚</li>
<li>è¿™æ˜¯ä¸ªå¤æ‚å¯¹è±¡ï¼ŒåŸºæœ¬æ¶µç›–äº†å„ç§ç±»å‹çš„æ•°æ®ã€‚</li>
</ul>
<h1 id="8-AutoConstructorTest"><a href="#8-AutoConstructorTest" class="headerlink" title="8. AutoConstructorTest"></a>8. AutoConstructorTest</h1><p><code>org.apache.ibatis.autoconstructor.AutoConstructorTest</code> ï¼Œå•å…ƒæµ‹è¯•ç±»ã€‚</p>
<h2 id="8-1-setUp"><a href="#8-1-setUp" class="headerlink" title="8.1 setUp"></a>8.1 setUp</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BeforeClass</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">    <span class="comment">// create a SqlSessionFactory</span></span><br><span class="line">    <span class="comment">// åˆ›å»º SqlSessionFactory å¯¹è±¡ï¼ŒåŸºäº mybatis-config.xml é…ç½®æ–‡ä»¶ã€‚</span></span><br><span class="line">    <span class="keyword">try</span> (Reader reader = Resources.getResourceAsReader(<span class="string">"org/apache/ibatis/autoconstructor/mybatis-config.xml"</span>)) {</span><br><span class="line">        sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(reader);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// populate in-memory database</span></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ•°æ®åˆ°å†…å­˜æ•°æ®åº“ï¼ŒåŸºäº CreateDB.sql SQL æ–‡ä»¶ã€‚</span></span><br><span class="line">    BaseDataTest.runScript(sqlSessionFactory.getConfiguration().getEnvironment().getDataSource(),</span><br><span class="line">            <span class="string">"org/apache/ibatis/autoconstructor/CreateDB.sql"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åˆ›å»º SqlSessionFactory å¯¹è±¡ï¼ŒåŸºäº <code>mybatis-config.xml</code> é…ç½®æ–‡ä»¶ã€‚</li>
<li>åˆå§‹åŒ–æ•°æ®åˆ°å†…å­˜æ•°æ®åº“ï¼ŒåŸºäº <code>CreateDB.sql</code> SQL æ–‡ä»¶ã€‚</li>
</ul>
<h2 id="8-2-æµ‹è¯•æ–¹æ³•"><a href="#8-2-æµ‹è¯•æ–¹æ³•" class="headerlink" title="8.2 æµ‹è¯•æ–¹æ³•"></a>8.2 æµ‹è¯•æ–¹æ³•</h2><p>å³é”®ä»»ä¸€å•å…ƒæµ‹è¯•æ–¹æ³•ï¼Œæ„‰å¿«çš„è°ƒè¯•èµ·æ¥æŠŠã€‚</p>
<h1 id="666-å½©è›‹"><a href="#666-å½©è›‹" class="headerlink" title="666. å½©è›‹"></a>666. å½©è›‹</h1><p>å°æ’¸æ€¡æƒ…ï¼Œå¤§æ’¸ä¼¤èº«ã€‚</p>




</div>
<div class="article-info article-info-index">



<div class="article-category tagcloud">
<i class="icon-book icon"></i>
<ul class="article-tag-list">

<li class="article-tag-list-item">
<a href="/categories/MyBatis//" class="article-tag-list-link color3">MyBatis</a>
</li>

</ul>
</div>





<div class="clearfix"></div>
</div>
</div>