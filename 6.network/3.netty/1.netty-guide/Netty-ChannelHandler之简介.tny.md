<div class="article-inner">


<header class="article-header">


<h1 class="article-title" itemprop="name">
ç²¾å°½ Netty æºç è§£æ â€”â€” ChannelHandlerï¼ˆä¸€ï¼‰ä¹‹ç®€ä»‹
</h1>


</header>

<div class="article-entry" itemprop="articleBody">

<!-- Table of Contents -->

<h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><p>åœ¨ <a href="http://svip.iocoder.cn/Netty/intro-2/?self">ã€Šç²¾å°½ Netty æºç åˆ†æ â€”â€” Netty ç®€ä»‹ï¼ˆäºŒï¼‰ä¹‹æ ¸å¿ƒç»„ä»¶ã€‹</a> ä¸­ï¼Œå¯¹ ChannelHandler åšäº†å®šä¹‰ï¼Œæˆ‘ä»¬å†æ¥å›é¡¾ä¸‹ï¼š</p>
<blockquote>
<p>ChannelHandler ï¼Œè¿æ¥é€šé“å¤„ç†å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ Netty ä¸­<strong>æœ€å¸¸ç”¨</strong>çš„ç»„ä»¶ã€‚ChannelHandler ä¸»è¦ç”¨æ¥å¤„ç†å„ç§äº‹ä»¶ï¼Œè¿™é‡Œçš„äº‹ä»¶å¾ˆå¹¿æ³›ï¼Œæ¯”å¦‚å¯ä»¥æ˜¯è¿æ¥ã€æ•°æ®æ¥æ”¶ã€å¼‚å¸¸ã€æ•°æ®è½¬æ¢ç­‰ã€‚</p>
</blockquote>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å·²ç»åœ¨å‰é¢çš„æ–‡ç« çœ‹äº†ä¸€éåˆä¸€é ChannelHandler çš„èº«å½±ï¼Œå·²ç»æ˜¯ç†Ÿæ‚‰çš„è€æœ‹å‹äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šåœ¨è¿™ä¸ª<strong>ä¸“å±</strong>äº ChannelHandler ç« èŠ‚é‡Œï¼Œå†æ›´åŠ æ·±å…¥çš„è®¤è¯† ChannelHandler ã€‚</p>
<p><code>io.netty.channel.ChannelHandler</code> ï¼ŒChannel å¤„ç†å™¨æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ChannelHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets called after the {<span class="doctag">@link</span> ChannelHandler} was added to the actual context and it's ready to handle events.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ChannelHandler å·²ç»æˆåŠŸè¢«æ·»åŠ åˆ° ChannelPipeline ä¸­ï¼Œå¯ä»¥è¿›è¡Œå¤„ç†äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¯¥æ–¹æ³•ï¼Œä¸€èˆ¬ç”¨äº ChannelHandler çš„åˆå§‹åŒ–çš„é€»è¾‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handlerAdded</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets called after the {<span class="doctag">@link</span> ChannelHandler} was removed from the actual context and it doesn't handle events</span></span><br><span class="line"><span class="comment">     * anymore.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ChannelHandler å·²ç»æˆåŠŸä» ChannelPipeline ä¸­è¢«ç§»é™¤ï¼Œä¸å†è¿›è¡Œå¤„ç†äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¯¥æ–¹æ³•ï¼Œä¸€èˆ¬ç”¨äº ChannelHandler çš„é”€æ¯çš„é€»è¾‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handlerRemoved</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets called if a {<span class="doctag">@link</span> Throwable} was thrown.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * æŠ“å–åˆ°å¼‚å¸¸ã€‚ç›®å‰è¢«åºŸå¼ƒï¼Œç§»åˆ° ChannelInboundHandler æ¥å£ä¸­ï¼Œä½œä¸ºå¯¹ Exception Inbound äº‹ä»¶çš„å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@deprecated</span> is part of {<span class="doctag">@link</span> ChannelInboundHandler}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Indicates that the same instance of the annotated {<span class="doctag">@link</span> ChannelHandler}</span></span><br><span class="line"><span class="comment">     * can be added to one or more {<span class="doctag">@link</span> ChannelPipeline}s multiple times</span></span><br><span class="line"><span class="comment">     * without a race condition.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * If this annotation is not specified, you have to create a new handler</span></span><br><span class="line"><span class="comment">     * instance every time you add it to a pipeline because it has unshared</span></span><br><span class="line"><span class="comment">     * state such as member variables.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * This annotation is provided for documentation purpose, just like</span></span><br><span class="line"><span class="comment">     * &lt;a href="http://www.javaconcurrencyinpractice.com/annotations/doc/"&gt;the JCIP annotations&lt;/a&gt;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Inherited</span></span><br><span class="line">    <span class="meta">@Documented</span></span><br><span class="line">    <span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line">    <span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line">    <span class="meta">@interface</span> Sharable {</span><br><span class="line">        <span class="comment">// no value</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å…³äº <code>#handlerAdded(...)</code>ã€<code>#handlerRemoved(...)</code>ã€<code>#exceptionCaught(...)</code> æ–¹æ³•ï¼Œèƒ–å‹çœ‹æ–¹æ³•ä¸Šçš„æ³¨é‡Šã€‚</li>
<li><code>@Sharable</code> æ³¨è§£ï¼ŒChannelHandler æ˜¯å¦å¯å…±äº«ï¼Œå³æ˜¯å¦å¯ä»¥è¢«<strong>å¤šæ¬¡</strong>æ·»åŠ ã€‚åœ¨ <a href="http://svip.iocoder.cn/Netty/Pipeline-2-add-channel-handler?self">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelPipelineï¼ˆäºŒï¼‰ä¹‹æ·»åŠ  ChannelHandlerã€‹</a> çš„ <a href="#">ã€Œ3. checkMultiplicityã€</a> å°èŠ‚ï¼Œå·²ç»æœ‰è¯¦ç»†è§£æã€‚</li>
</ul>
<h1 id="2-æ ¸å¿ƒç±»"><a href="#2-æ ¸å¿ƒç±»" class="headerlink" title="2. æ ¸å¿ƒç±»"></a>2. æ ¸å¿ƒç±»</h1><p>ChannelHandler çš„<strong>æ ¸å¿ƒç±»</strong>çš„ç±»å›¾å¦‚ä¸‹å›¾ï¼š</p>
<p><a href="http://static2.iocoder.cn/images/Netty/2018_10_01/01.png" title="æ ¸å¿ƒç±»å›¾" class="fancybox" rel="article0"><img src="http://static2.iocoder.cn/images/Netty/2018_10_01/01.png" alt="æ ¸å¿ƒç±»å›¾"></a><span class="caption">æ ¸å¿ƒç±»å›¾</span></p>
<ul>
<li>ChannelInboundHandler ï¼Œåœ¨ <a href="http://svip.iocoder.cn/Netty/Pipeline-5-inbound">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelPipelineï¼ˆäº”ï¼‰ä¹‹ Inbound äº‹ä»¶çš„ä¼ æ’­ã€‹</a> æœ‰è¯¦ç»†è§£æã€‚</li>
<li>ChannelOutboundHandler ï¼Œåœ¨ <a href="http://svip.iocoder.cn/Netty/Pipeline-6-outbound">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelPipelineï¼ˆå…­ï¼‰ä¹‹ Outbound äº‹ä»¶çš„ä¼ æ’­ã€‹</a> æœ‰è¯¦ç»†è§£æã€‚</li>
<li><strong>çº¢æ¡†</strong>éƒ¨åˆ†ï¼ŒChannelHandler Adaptive å®ç°ç±»ï¼Œæä¾›é»˜è®¤çš„éª¨æ¶( Skeleton )å®ç°ã€‚</li>
<li><strong>ç»¿æ¡†</strong>éƒ¨åˆ†ï¼Œç”¨äºç¼–è§£ç æ¶ˆæ¯çš„ ChannelHandler å®ç°ç±»ã€‚å…³äºè¿™éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šåœ¨ ã€ŠCodecã€‹ä¸“å±çš„ç« èŠ‚ï¼Œè€Œä¸æ˜¯åœ¨ã€ŠChannelHandlerã€‹ç« èŠ‚ã€‚</li>
<li><strong>é»„æ¡†</strong>éƒ¨åˆ†<ul>
<li>SimpleChannelInboundHandler ï¼ŒæŠ½è±¡ç±»ï¼Œå¤„ç†<strong>æŒ‡å®šç±»å‹</strong>çš„æ¶ˆæ¯ã€‚åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®ç° SimpleChannelInboundHandler åï¼Œå®ç°å¯¹<strong>æŒ‡å®šç±»å‹</strong>çš„æ¶ˆæ¯çš„è‡ªå®šä¹‰å¤„ç†ã€‚</li>
<li>Simple<strong>UserEvent</strong>ChannelHandler ï¼Œå’Œ SimpleChannelInboundHandler åŸºæœ¬ä¸€è‡´ï¼Œå·®åˆ«åœ¨äºå°†æŒ‡å®šç±»å‹çš„æ¶ˆæ¯ï¼Œæ”¹æˆäº†åˆ¶å®šç±»å‹çš„äº‹ä»¶ã€‚</li>
<li>è¯¦ç»†è§£æï¼Œè§ <a href="http://svip.iocoder.cn/Netty/ChannelHandler-3-SimpleChannelInboundHandler">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelHandlerï¼ˆä¸‰ï¼‰ä¹‹ SimpleChannelInboundHandlerã€‹</a> ã€‚</li>
</ul>
</li>
<li>ChannelInitializer ï¼Œä¸€ä¸ª<strong>ç‰¹æ®Š</strong>çš„ ChannelHandler ï¼Œç”¨äº Channel æ³¨å†Œåˆ° EventLoop åï¼Œ<strong>æ‰§è¡Œè‡ªå®šä¹‰çš„åˆå§‹åŒ–æ“ä½œ</strong>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰çš„ ChannelHandler åˆ° Channel ä¸­ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="http://svip.iocoder.cn/Netty/ChannelHandler-2-ChannelInitializer">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelHandlerï¼ˆäºŒï¼‰ä¹‹ ChannelInitializerã€‹</a> ã€‚</li>
</ul>
<h1 id="3-ChannelHandlerAdaptive"><a href="#3-ChannelHandlerAdaptive" class="headerlink" title="3. ChannelHandlerAdaptive"></a>3. ChannelHandlerAdaptive</h1><p>åœ¨çœ‹çœ‹ ChannelHandlerAdaptive çš„å…·ä½“ä»£ç å®ç°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä¸€èµ·äº†è§£ ChannelHandlerAdaptive çš„è®¾è®¡æ€æƒ³ã€‚åœ¨ã€ŠNetty æƒå¨æŒ‡å—ã€‹å¦‚æ˜¯è¯´ï¼š</p>
<blockquote>
<p>å¯¹äºå¤§å¤šæ•°çš„ ChannelHandler ä¼šé€‰æ‹©æ€§åœ°æ‹¦æˆªå’Œå¤„ç†æŸä¸ªæˆ–è€…æŸäº›äº‹ä»¶ï¼Œå…¶ä»–çš„äº‹ä»¶ä¼šå¿½ç•¥ï¼Œç”±ä¸‹ä¸€ä¸ª ChannelHandler è¿›è¡Œæ‹¦æˆªå’Œå¤„ç†ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼šç”¨æˆ· ChannelHandler å¿…é¡»è¦å®ç° ChannelHandler çš„æ‰€æœ‰æ¥å£ï¼ŒåŒ…æ‹¬å®ƒä¸å…³å¿ƒçš„é‚£äº›äº‹ä»¶å¤„ç†æ¥å£ï¼Œè¿™ä¼šå¯¼è‡´ç”¨æˆ·ä»£ç çš„å†—ä½™å’Œè‡ƒè‚¿ï¼Œä»£ç çš„å¯ç»´æŠ¤æ€§ä¹Ÿä¼šå˜å·®ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNettyæä¾›äº†ChannelHandlerAdapteråŸºç±»ï¼Œå®ƒçš„æ‰€æœ‰æ¥å£å®ç°éƒ½æ˜¯äº‹ä»¶é€ä¼ ï¼Œå¦‚æœç”¨æˆ·ChannelHandlerå…³å¿ƒæŸä¸ªäº‹ä»¶ï¼Œåªéœ€è¦è¦†ç›–ChannelHandlerAdapterå¯¹åº”çš„æ–¹æ³•å³å¯ï¼Œå¯¹äºä¸å…³å¿ƒçš„ï¼Œå¯ä»¥ç›´æ¥ç»§æ‰¿ä½¿ç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¿™æ ·å­ç±»çš„ä»£ç å°±ä¼šéå¸¸ç®€æ´å’Œæ¸…æ™°ã€‚</p>
</blockquote>
<p>ğŸ˜ˆ ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„å…¶å®ƒ Adaptive å®ç°ç±»ï¼Œä¹Ÿæ˜¯è¿™æ ·çš„è®¾è®¡æ€æƒ³ã€‚</p>
<hr>
<p><code>io.netty.channel.ChannelHandlerAdapter</code> ï¼Œå®ç° ChannelHandler æ¥å£ï¼ŒChannelHandler Adapter æŠ½è±¡ç±»ã€‚</p>
<h2 id="3-1-isSharable"><a href="#3-1-isSharable" class="headerlink" title="3.1 isSharable"></a>3.1 isSharable</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// Not using volatile because it's used only for a sanity check.</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ˜¯å¦å·²ç»åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">boolean</span> added;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Throws {<span class="doctag">@link</span> IllegalStateException} if {<span class="doctag">@link</span> ChannelHandlerAdapter#isSharable()} returns {<span class="doctag">@code</span> true}</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">ensureNotSharable</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (isSharable()) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"ChannelHandler "</span> + getClass().getName() + <span class="string">" is not allowed to be shared"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Return {<span class="doctag">@code</span> true} if the implementation is {<span class="doctag">@link</span> Sharable} and so can be added</span></span><br><span class="line"><span class="comment"> * to different {<span class="doctag">@link</span> ChannelPipeline}s.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSharable</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Cache the result of {<span class="doctag">@link</span> Sharable} annotation detection to workaround a condition. We use a</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@link</span> ThreadLocal} and {<span class="doctag">@link</span> WeakHashMap} to eliminate the volatile write/reads. Using different</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@link</span> WeakHashMap} instances per {<span class="doctag">@link</span> Thread} is good enough for us and the number of</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@link</span> Thread}s are quite limited anyway.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * See &lt;a href="https://github.com/netty/netty/issues/2289"&gt;#2289&lt;/a&gt;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Class&lt;?&gt; clazz = getClass();</span><br><span class="line">    Map&lt;Class&lt;?&gt;, Boolean&gt; cache = InternalThreadLocalMap.get().handlerSharableCache();</span><br><span class="line">    Boolean sharable = cache.get(clazz);</span><br><span class="line">    <span class="keyword">if</span> (sharable == <span class="keyword">null</span>) {</span><br><span class="line">        sharable = clazz.isAnnotationPresent(Sharable.class);</span><br><span class="line">        cache.put(clazz, sharable);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> sharable;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è¿™å—å†…å®¹ï¼Œå’Œ <code>@Sharable</code> æ³¨è§£ç›¸å…³ã€‚åœ¨ <a href="http://svip.iocoder.cn/Netty/Pipeline-2-add-channel-handler?self">ã€Šç²¾å°½ Netty æºç è§£æ â€”â€” ChannelPipelineï¼ˆäºŒï¼‰ä¹‹æ·»åŠ  ChannelHandlerã€‹</a> çš„ <a href="#">ã€Œ3. checkMultiplicityã€</a> å°èŠ‚ï¼Œå·²ç»æœ‰è¯¦ç»†è§£æã€‚</li>
</ul>
<h2 id="3-2-å…·ä½“å®ç°"><a href="#3-2-å…·ä½“å®ç°" class="headerlink" title="3.2 å…·ä½“å®ç°"></a>3.2 å…·ä½“å®ç°</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Do nothing by default, sub-classes may override this method.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handlerAdded</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">    <span class="comment">// NOOP</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Do nothing by default, sub-classes may override this method.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handlerRemoved</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">    <span class="comment">// NOOP</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireExceptionCaught(Throwable)} to forward</span></span><br><span class="line"><span class="comment"> * to the next {<span class="doctag">@link</span> ChannelHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">    ctx.fireExceptionCaught(cause);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯¹äº <code>#handlerAdded(ChannelHandlerContext ctx)</code> å’Œ <code>#handlerRemoved(ChannelHandlerContext ctx)</code> æ–¹æ³•ï¼Œé»˜è®¤æ— ä»»ä½•é€»è¾‘ã€‚å­ç±»å¦‚æœæœ‰è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œå¯ä»¥è¿›è¡Œè¦†å†™å¯¹åº”çš„æ–¹æ³•ã€‚</li>
<li><code>#exceptionCaught(ChannelHandlerContext ctx, Throwable cause)</code> æ–¹æ³•ï¼Œç›´æ¥è½¬å‘åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ<strong>å®é™…ä¸Š</strong>ä¹Ÿæ˜¯é»˜è®¤æ— ä»»ä½•é€»è¾‘ã€‚å­ç±»å¦‚æœæœ‰è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œå¯ä»¥è¿›è¡Œè¦†å†™å¯¹åº”çš„æ–¹æ³•ã€‚</li>
</ul>
<h1 id="4-ChannelOutboundHandlerAdapter"><a href="#4-ChannelOutboundHandlerAdapter" class="headerlink" title="4. ChannelOutboundHandlerAdapter"></a>4. ChannelOutboundHandlerAdapter</h1><p><code>io.netty.channel.ChannelOutboundHandlerAdapter</code> ï¼Œå®ç° ChannelOutboundHandler æ¥å£ï¼Œç»§æ‰¿ ChannelHandlerAdapter æŠ½è±¡ç±»ï¼ŒChannelOutboundHandler Adapter å®ç°ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChannelOutboundHandlerAdapter</span> <span class="keyword">extends</span> <span class="title">ChannelHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">ChannelOutboundHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#bind(SocketAddress, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(ChannelHandlerContext ctx, SocketAddress localAddress, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.bind(localAddress, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#connect(SocketAddress, SocketAddress, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">(ChannelHandlerContext ctx, SocketAddress remoteAddress, SocketAddress localAddress, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.connect(remoteAddress, localAddress, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#disconnect(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">disconnect</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.disconnect(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#close(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.close(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#deregister(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deregister</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.deregister(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#read()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.read();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#write(Object, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.write(msg, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#flush()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.flush();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ¯ä¸ªå®ç°æ–¹æ³•ï¼Œç›´æ¥è½¬å‘åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ<strong>å®é™…ä¸Š</strong>ä¹Ÿæ˜¯é»˜è®¤æ— ä»»ä½•é€»è¾‘ã€‚å­ç±»å¦‚æœæœ‰è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œå¯ä»¥è¿›è¡Œè¦†å†™å¯¹åº”çš„æ–¹æ³•ã€‚</li>
</ul>
<h1 id="5-ChannelInboundHandlerAdapter"><a href="#5-ChannelInboundHandlerAdapter" class="headerlink" title="5. ChannelInboundHandlerAdapter"></a>5. ChannelInboundHandlerAdapter</h1><p><code>io.netty.channel.ChannelInboundHandlerAdapter</code> ï¼Œå®ç° ChannelInboundHandler æ¥å£ï¼Œç»§æ‰¿ ChannelHandlerAdapter æŠ½è±¡ç±»ï¼ŒChannelInboundHandler Adapter å®ç°ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChannelInboundHandlerAdapter</span> <span class="keyword">extends</span> <span class="title">ChannelHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">ChannelInboundHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelRegistered()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelRegistered</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelRegistered();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelUnregistered()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelUnregistered</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelUnregistered();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelActive()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelActive();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelInactive()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelInactive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelInactive();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelRead(Object)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelRead(msg);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelReadComplete()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelReadComplete</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelReadComplete();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireUserEventTriggered(Object)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">userEventTriggered</span><span class="params">(ChannelHandlerContext ctx, Object evt)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireUserEventTriggered(evt);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireChannelWritabilityChanged()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelInboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelWritabilityChanged</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireChannelWritabilityChanged();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#fireExceptionCaught(Throwable)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.fireExceptionCaught(cause);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ¯ä¸ªå®ç°æ–¹æ³•ï¼Œç›´æ¥è½¬å‘åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ<strong>å®é™…ä¸Š</strong>ä¹Ÿæ˜¯é»˜è®¤æ— ä»»ä½•é€»è¾‘ã€‚å­ç±»å¦‚æœæœ‰è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œå¯ä»¥è¿›è¡Œè¦†å†™å¯¹åº”çš„æ–¹æ³•ã€‚</li>
</ul>
<h1 id="6-ChannelDuplexHandler"><a href="#6-ChannelDuplexHandler" class="headerlink" title="6. ChannelDuplexHandler"></a>6. ChannelDuplexHandler</h1><p><code>io.netty.channel.ChannelDuplexHandler</code> ï¼Œå®ç° ChannelOutboundHandler æ¥å£ï¼Œç»§æ‰¿ ChannelInboundHandlerAdapter æŠ½è±¡ç±»ï¼ŒChannel Duplex Handler å®ç°ç±»ï¼Œæ”¯æŒå¯¹ Inbound å’Œ Outbound äº‹ä»¶çš„ Adaptive å¤„ç†ï¼Œæ‰€ä»¥å‘½åä¸Šå¸¦æœ‰â€œ<strong>Duplex</strong>â€( åŒé‡ )ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChannelDuplexHandler</span> <span class="keyword">extends</span> <span class="title">ChannelInboundHandlerAdapter</span> <span class="keyword">implements</span> <span class="title">ChannelOutboundHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#bind(SocketAddress, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(ChannelHandlerContext ctx, SocketAddress localAddress, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.bind(localAddress, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#connect(SocketAddress, SocketAddress, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connect</span><span class="params">(ChannelHandlerContext ctx, SocketAddress remoteAddress, SocketAddress localAddress, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.connect(remoteAddress, localAddress, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#disconnect(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">disconnect</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.disconnect(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#close(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.close(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#close(ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deregister</span><span class="params">(ChannelHandlerContext ctx, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.deregister(promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#read()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.read();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#write(Object, ChannelPromise)} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.write(msg, promise);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Calls {<span class="doctag">@link</span> ChannelHandlerContext#flush()} to forward</span></span><br><span class="line"><span class="comment">     * to the next {<span class="doctag">@link</span> ChannelOutboundHandler} in the {<span class="doctag">@link</span> ChannelPipeline}.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Sub-classes may override this method to change behavior.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ctx.flush();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å®ç°ä»£ç ä¸Šï¼Œå’Œ <a href="#">ã€Œ4. ChannelOutboundHandlerAdapterã€</a> æ˜¯ä¸€è‡´çš„ã€‚å› ä¸º Java ä¸æ”¯æŒ<strong>å¤šç»§æ‰¿</strong>çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ä¸å¾—åˆé‡æ–°å®ç°ä¸€éã€‚</li>
</ul>
<p>ğŸ˜ˆ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå®ç° ChannelDuplexHandler ç±»ï¼Œè¦†å†™éƒ¨åˆ†æ–¹æ³•ï¼Œå¤„ç†å¯¹åº”çš„äº‹ä»¶ã€‚</p>
<h1 id="666-å½©è›‹"><a href="#666-å½©è›‹" class="headerlink" title="666. å½©è›‹"></a>666. å½©è›‹</h1><p>å°å°æ°´æ–‡ä¸€ç¯‡ï¼Œä¸»è¦å¸®èƒ–å‹æ¢³ç†ä¸‹ï¼Œå¯¹ ChannelHandler æœ‰æ•´ä½“çš„è®¤è¯†ã€‚åœ¨åç»­çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹å…·ä½“çš„ä¸€ä¸ªä¸€ä¸ª ChannelHandler çš„å¸¦æœ‰â€œä¸šåŠ¡â€çš„å®ç°ç±»ã€‚</p>
<p>æ¨èé˜…è¯»å¦‚ä¸‹æ–‡ç« ï¼š</p>
<ul>
<li>Hypercube <a href="https://www.jianshu.com/p/a9bcd89553f5" rel="external nofollow noopener noreferrer" target="_blank">ã€Šè‡ªé¡¶å‘ä¸‹æ·±å…¥åˆ†æNettyï¼ˆå…«ï¼‰â€“ChannelHandlerã€‹</a></li>
</ul>


</div>
<!--
<footer class="article-footer">
<a data-url="http://svip.iocoder.cn/Netty/ChannelHandler-1-intro/" data-id="ck4pl3fp700e8fgcfgzlsuuif" class="article-share-link">åˆ†äº«</a>



</footer>
-->
</div>