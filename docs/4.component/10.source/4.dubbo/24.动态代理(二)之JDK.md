# åŠ¨æ€ä»£ç†ï¼ˆäºŒï¼‰ä¹‹ JDK

æœ¬æ–‡åŸºäº Dubbo 2.6.1 ç‰ˆæœ¬ï¼Œæœ›çŸ¥æ‚‰ã€‚

# 1. æ¦‚è¿°

æœ¬æ–‡æ¥ [ã€Šç²¾å°½ Dubbo æºç åˆ†æ â€”â€” åŠ¨æ€ä»£ç†ï¼ˆä¸€ï¼‰ä¹‹ Javassistã€‹](http://svip.iocoder.cn/Dubbo/proxy-javassist/?self) ä¸€æ–‡ï¼Œåˆ†äº«ä½¿ç”¨ **JDK** ç”ŸæˆåŠ¨æ€ä»£ç†çš„ä»£ç å®ç°ã€‚

å¦‚æœ JDK Proxy ä¸ç†Ÿæ‚‰çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹ä¸‹ [ã€Š Java JDK åŠ¨æ€ä»£ç†ï¼ˆAOPï¼‰ä½¿ç”¨åŠå®ç°åŸç†åˆ†æã€‹](http://blog.csdn.net/jiankunking/article/details/52143504) å­¦ä¹ ä¸‹ã€‚ğŸ™‚ å­¦æ— æ­¢å¢ƒå‘€ã€‚

å¦å¤–ï¼Œå¦‚æœä½¿ç”¨ JDK ç”Ÿæˆä»£ç†ï¼Œé…ç½®æ–¹å¼å¦‚ä¸‹ï¼š

```
// æœåŠ¡å¼•ç”¨
<dubbo:reference proxy="jdk" />
// æœåŠ¡æš´éœ²
<dubbo:service proxy="jdk" />
```

# 2. JdkProxyFactory

com.alibaba.dubbo.rpc.proxy.jdk.JdkProxyFactory
ï¼Œå®ç° AbstractProxyInvoker æŠ½è±¡ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
1: public class JdkProxyFactory extends AbstractProxyFactory{
2:
3: @SuppressWarnings("unchecked")
4: public <T> T getProxy(Invoker<T> invoker, Class<?>[] interfaces){
5: return (T) Proxy.newProxyInstance(Thread.currentThread().getContextClassLoader(), interfaces, new InvokerInvocationHandler(invoker));
6: }
7:
8: public <T> Invoker<T> getInvoker(T proxy, Class<T> type, URL url){
9: return new AbstractProxyInvoker<T>(proxy, type, url) {
10: @Override
11: protected Object doInvoke(T proxy, String methodName,
12: Class<?>[] parameterTypes,
13: Object[] arguments) throws Throwable{
14: // è·å¾—æ–¹æ³•
15: Method method = proxy.getClass().getMethod(methodName, parameterTypes);
16: // è°ƒç”¨æ–¹æ³•
17: return method.invoke(proxy, arguments);
18: }
19: };
20: }
21:
22: }
```

- /#getProxy(invoker, interfaces)
  æ–¹æ³•

- ç¬¬ 5 è¡Œï¼šåˆ›å»º InvokerInvocationHandler å¯¹è±¡ï¼Œä¼ å…¥

invoker
å¯¹è±¡ã€‚

- ç¬¬ 5 è¡Œï¼šè°ƒç”¨

java.lang.reflect.Proxy/#getProxy(ClassLoader loader, Class<?>[] interfaces, InvocationHandler h)
æ–¹æ³•ï¼Œåˆ›å»º Proxy å¯¹è±¡ã€‚

- ğŸ™‚ ç›¸æ¯” Javassist ç²¾ç®€å¾ˆå¤šï¼ŒæœŸå¾… JDK Proxy çš„ä¸æ–­æ€§èƒ½ä¼˜åŒ–ã€‚
- /#getInvoker(proxy, type, url)
  æ–¹æ³•

- ç¬¬ 9 è‡³ 19 è¡Œï¼šåˆ›å»º AbstractProxyInvoker å¯¹è±¡ï¼Œå®ç°

/#doInvoker(...)
æ–¹æ³•ã€‚

- ç¬¬ 15 è¡Œï¼šè°ƒç”¨

Class/#getMethod(String name, Class<?>... parameterTypes)
æ–¹æ³•ï¼Œåå°„è·å¾—æ–¹æ³•ã€‚

- ç¬¬ 17 è¡Œï¼šè°ƒç”¨

Method/#invoke(proxy, arguments)
æ–¹æ³•ï¼Œæ‰§è¡Œæ–¹æ³•ã€‚

- æ¨èé˜…è¯»ï¼š[ã€ŠJava åå°„åŸç†ç®€æã€‹](http://www.fanyilun.me/2015/10/29/Java%E5%8F%8D%E5%B0%84%E5%8E%9F%E7%90%86/)
