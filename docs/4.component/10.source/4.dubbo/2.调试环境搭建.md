# è°ƒè¯•ç¯å¢ƒæ­å»º

æœ¬æ–‡åŸºäº Dubbo 2.6.1 ç‰ˆæœ¬ï¼Œæœ›çŸ¥æ‚‰ã€‚

# 1. ä¾èµ–å·¥å…·

- Maven
- Git
- JDK
- IntelliJ IDEA

# 2. æºç æ‹‰å–

ä»å®˜æ–¹ä»“åº“ [https://github.com/alibaba/dubbo](https://github.com/alibaba/dubbo)

Fork
å‡ºå±äºè‡ªå·±çš„ä»“åº“ã€‚ä¸ºä»€ä¹ˆè¦

Fork
ï¼Ÿæ—¢ç„¶å¼€å§‹é˜…è¯»ã€è°ƒè¯•æºç ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™ä¸€äº›æ³¨é‡Šï¼Œæœ‰äº†è‡ªå·±çš„ä»“åº“ï¼Œå¯ä»¥è¿›è¡Œè‡ªç”±çš„æäº¤ã€‚ğŸ˜ˆ

ä½¿ç”¨

IntelliJ IDEA
ä»

Fork
å‡ºæ¥çš„ä»“åº“æ‹‰å–ä»£ç ã€‚æ‹‰å–å®Œæˆåï¼Œ

Maven
ä¼šä¸‹è½½ä¾èµ–åŒ…ï¼Œå¯èƒ½ä¼šèŠ±è´¹ä¸€äº›æ—¶é—´ï¼Œè€å¿ƒç­‰å¾…ä¸‹ã€‚

åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€å¼  Dubbo çš„æ¶æ„å›¾![](http://static2.iocoder.cn/images/Dubbo/2018_01_01/01.png)

åœ¨å›¾ä¸­ï¼Œæœ¬æ–‡ä¼šæ¶‰åŠåˆ°çš„æœ‰**ä¸‰ä¸ª**è§’è‰²ï¼š

- Registry æ³¨å†Œä¸­å¿ƒï¼Œç”¨äºæœåŠ¡çš„æ³¨å†Œä¸å‘ç°ã€‚
- Provider æœåŠ¡æä¾›è€…ï¼Œé€šè¿‡å‘ Registry æ³¨å†ŒæœåŠ¡ã€‚
- Consumer æœåŠ¡æ¶ˆè´¹è€…ï¼Œé€šè¿‡ä» Registry å‘ç°æœåŠ¡ã€‚

å¦å¤–ï¼ŒConsumer å¯¹ Provider çš„è°ƒç”¨ï¼Œ**ç›´æ¥å‘èµ·**ï¼Œæ— éœ€ç»è¿‡ Registry ã€‚

Dubbo æä¾›äº† [
dubbo-demo
](https://github.com/alibaba/dubbo/tree/2c20d99d9804271e1c1953242ea0aa510854eda1/dubbo-common) é¡¹ç›®ï¼Œç”¨äºå¼€å‘è€…å¿«é€Ÿå…¥é—¨ã€‚
æœ¬æ–‡ä¹Ÿä½¿ç”¨è¯¥é¡¹ç›®ï¼Œæ­å»ºè°ƒè¯•ç¯å¢ƒã€‚

# 3. Registry

Dubbo æä¾›äº†å¤šç§ Registry çš„å®ç°ï¼Œå‚è§ [ã€Šæ³¨å†Œä¸­å¿ƒå‚è€ƒæ‰‹å†Œã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/registry/introduction.html) ã€‚

åœ¨ **
dubbo-demoï¼ˆmodelï¼‰
**é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ Multicast Registry ã€‚
å®é™…**ç”Ÿäº§ç¯å¢ƒ**ä¸­ï¼Œä½¿ç”¨ Zookeeper Registry ã€‚
å‹æƒ…æç¤ºï¼š[ã€Œ3.1 Multicast Registryã€](http://svip.iocoder.cn/Dubbo/build-debugging-environment/) å’Œ [ã€Œ3.2 Zookeeper Registryã€](http://svip.iocoder.cn/Dubbo/build-debugging-environment/) äºŒé€‰ä¸€ï¼Œå»ºè®®å…ˆä½¿ç”¨å‰è€…æ­å»ºè°ƒè¯•ç¯å¢ƒï¼Œå› ä¸ºç®€å•æ–¹ä¾¿ã€‚

## 3.1 Multicast Registry

Multicast Registry åŸºäº [ç»„æ’­åè®®](http://blog.csdn.net/liu251890347/article/details/39211685) å®ç°ï¼Œè¯¦ç»†å‚è§æ–‡æ¡£ [ã€ŠMulticast æ³¨å†Œä¸­å¿ƒã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/registry/multicast.html) ã€‚
Multicast æ³¨å†Œä¸­å¿ƒä¸éœ€è¦å¯åŠ¨ä»»ä½•ä¸­å¿ƒèŠ‚ç‚¹ï¼Œåªè¦å¹¿æ’­åœ°å€ä¸€æ ·ï¼Œå°±å¯ä»¥äº’ç›¸å‘ç°ã€‚

**æ³¨æ„**ï¼Œä¸éœ€è¦å¯åŠ¨ï¼ï¼ï¼ç®€å•çš„è¯´ï¼Œæœ¬å°èŠ‚çš„å†…å®¹å¯ä»¥ç›´æ¥è·³è¿‡ã€‚

## 3.2 Zookeeper Registry

Zookeeper Registry åŸºäº [Zookeeper](https://zookeeper.apache.org/) å®ç°ï¼Œè¯¦ç»†å‚è§æ–‡æ¡£ [ã€Šzookeeper æ³¨å†Œä¸­å¿ƒã€‹](http://dubbo.apache.org/zh-cn/docs/user/references/registry/zookeeper.html) ã€‚

æ­å»ºæ­¥éª¤å¦‚ä¸‹ï¼š

1ã€å¯åŠ¨ Zookeeper æœåŠ¡ã€‚

```
å‹ç¼©åŒ…å®‰è£…æˆ–è€…dockerå®‰è£…
docker run --name zookeeper3.5 -p 7998:2181 -d zookeeper:3.5
```

2ã€ä¿®æ”¹ [
dubbo-demo-provider.xml
](https://github.com/alibaba/dubbo/blob/2c20d99d9804271e1c1953242ea0aa510854eda1/dubbo-demo/dubbo-demo-provider/src/main/resources/META-INF/spring/dubbo-demo-provider.xml) ï¼Œå¯åŠ¨ Provider ã€‚

```
<!--<dubbo:registry address="multicast://224.5.6.7:1234"/>-->
<dubbo:registry address="zookeeper://127.0.0.1:2181"/>
```

3ã€ä¿®æ”¹ [
dubbo-demo-consumer.xml
](https://github.com/alibaba/dubbo/blob/2c20d99d9804271e1c1953242ea0aa510854eda1/dubbo-demo/dubbo-demo-consumer/src/main/resources/META-INF/spring/dubbo-demo-consumer.xml) ï¼Œå¯åŠ¨ Consumer ã€‚

```
<!--<dubbo:registry address="multicast://224.5.6.7:1234"/>-->
<dubbo:registry address="zookeeper://127.0.0.1:2181"/>
```

# 4. Provider

åœ¨ IDEA ä¸­ï¼Œå³é”® **Debug** è¿è¡Œ [
com.alibaba.dubbo.demo.provider.Provider
](https://github.com/alibaba/dubbo/blob/HEAD/dubbo-demo/dubbo-demo-provider/src/main/java/com/alibaba/dubbo/demo/provider/Provider.java) ã€‚

å½“è¾“å‡ºå¦‚ä¸‹æ—¥å¿—ï¼Œè¡¨ç¤ºæˆåŠŸï¼š

```
[18/02/18 10:04:42:042 CST] main INFO support.ClassPathXmlApplicationContext: Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@cd2dae5: startup date [Sun Feb 18 10:04:42 CST 2018]; root of context hierarchy
[18/02/18 10:04:42:042 CST] main INFO xml.XmlBeanDefinitionReader: Loading XML bean definitions from class path resource [META-INF/spring/dubbo-demo-provider.xml]
[18/02/18 10:04:42:042 CST] main INFO logger.LoggerFactory: using logger: com.alibaba.dubbo.common.logger.log4j.Log4jLoggerAdapter
[18/02/18 10:04:53:053 CST] main INFO config.AbstractConfig: [DUBBO] The service ready on spring started. service: com.alibaba.dubbo.demo.DemoService, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:13:013 CST] main INFO config.AbstractConfig: [DUBBO] Export dubbo service com.alibaba.dubbo.demo.DemoService to local registry, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:13:013 CST] main INFO config.AbstractConfig: [DUBBO] Export dubbo service com.alibaba.dubbo.demo.DemoService to url dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&bind.ip=192.168.1.116&bind.port=20880&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&qos.port=22222&side=provider&timestamp=1518919503284, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:13:013 CST] main INFO config.AbstractConfig: [DUBBO] Register dubbo service com.alibaba.dubbo.demo.DemoService url dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&bind.ip=192.168.1.116&bind.port=20880&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&qos.port=22222&side=provider&timestamp=1518919503284 to registry registry://224.5.6.7:1234/com.alibaba.dubbo.registry.RegistryService?application=demo-provider&dubbo=2.0.0&pid=43392&qos.port=22222&registry=multicast&timestamp=1518919493265, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:13:013 CST] main INFO transport.AbstractServer: [DUBBO] Start NettyServer bind /0.0.0.0:20880, export /192.168.1.116:20880, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] main INFO multicast.MulticastRegistry: [DUBBO] Register: dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] main INFO multicast.MulticastRegistry: [DUBBO] Send broadcast message: register dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284 to /224.5.6.7:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Receive multicast message: register dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284 from /192.168.1.116:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] main INFO multicast.MulticastRegistry: [DUBBO] Subscribe: provider://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&category=configurators&check=false&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] main INFO multicast.MulticastRegistry: [DUBBO] Send broadcast message: subscribe provider://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&category=configurators&check=false&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284 to /224.5.6.7:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:20:020 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Receive multicast message: subscribe provider://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&category=configurators&check=false&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284 from /192.168.1.116:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 10:05:21:021 CST] main WARN multicast.MulticastRegistry: [DUBBO] Ignore empty notify urls for subscribe url provider://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&category=configurators&check=false&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43392&side=provider&timestamp=1518919503284, dubbo version: 2.0.0, current host: 192.168.1.116
```

**æ³¨æ„**ï¼Œå¦‚æœä½¿ç”¨ Multicast Registry ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œåœ¨ IDEA ä¸­éœ€è¦ä½¿ç”¨ **Debug æ¨¡å¼**è¿è¡Œï¼ŒåŸå› å‚è§ï¼š[dubbo-demo set â€œjava.net.preferIPv4Stackâ€ not work](https://github.com/alibaba/dubbo/issues/997) ã€‚

# 5. Consumer

åœ¨ IDEA ä¸­ï¼Œå³é”® **Debug** è¿è¡Œ [
com.alibaba.dubbo.demo.consumer.Consumer
](https://github.com/alibaba/dubbo/blob/HEAD/dubbo-demo/dubbo-demo-consumer/src/main/java/com/alibaba/dubbo/demo/consumer/Consumer.java) ã€‚

å½“è¾“å‡ºå¦‚ä¸‹æ—¥å¿—ï¼Œè¡¨ç¤ºæˆåŠŸï¼š

```
[18/02/18 09:45:22:022 CST] main INFO support.ClassPathXmlApplicationContext: Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@cd2dae5: startup date [Sun Feb 18 09:45:22 CST 2018]; root of context hierarchy
[18/02/18 09:45:22:022 CST] main INFO xml.XmlBeanDefinitionReader: Loading XML bean definitions from class path resource [META-INF/spring/dubbo-demo-consumer.xml]
[18/02/18 09:45:22:022 CST] main INFO logger.LoggerFactory: using logger: com.alibaba.dubbo.common.logger.log4j.Log4jLoggerAdapter
[18/02/18 09:45:45:045 CST] main INFO multicast.MulticastRegistry: [DUBBO] Register: consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=consumers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] main INFO multicast.MulticastRegistry: [DUBBO] Send broadcast message: register consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=consumers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457 to /224.5.6.7:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] main INFO multicast.MulticastRegistry: [DUBBO] Subscribe: consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=providers,configurators,routers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Receive multicast message: register consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=consumers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457 from /192.168.1.116:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] main INFO multicast.MulticastRegistry: [DUBBO] Send broadcast message: subscribe consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=providers,configurators,routers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457 to /224.5.6.7:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Receive multicast message: subscribe consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=providers,configurators,routers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457 from /192.168.1.116:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Receive multicast message: register dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43355&side=provider&timestamp=1518918226970 from /192.168.1.116:1234, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO multicast.MulticastRegistry: [DUBBO] Notify urls for subscribe url consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=providers,configurators,routers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457, urls: [dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43355&side=provider&timestamp=1518918226970], dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO transport.AbstractClient: [DUBBO] Successed connect to server /192.168.1.116:20880 from NettyClient 192.168.1.116 using dubbo version 2.0.0, channel is NettyChannel [channel=[id: 0x1b7bac12, /192.168.1.116:63856 => /192.168.1.116:20880]], dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] DubboMulticastRegistryReceiver INFO transport.AbstractClient: [DUBBO] Start NettyClient 123312.local/192.168.1.116 connect to the server /192.168.1.116:20880, dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] main INFO multicast.MulticastRegistry: [DUBBO] Notify urls for subscribe url consumer://192.168.1.116/com.alibaba.dubbo.demo.DemoService?application=demo-consumer&category=providers,configurators,routers&check=false&dubbo=2.0.0&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&side=consumer&timestamp=1518918323457, urls: [dubbo://192.168.1.116:20880/com.alibaba.dubbo.demo.DemoService?anyhost=true&application=demo-provider&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43355&side=provider&timestamp=1518918226970], dubbo version: 2.0.0, current host: 192.168.1.116
[18/02/18 09:45:45:045 CST] main INFO config.AbstractConfig: [DUBBO] Refer dubbo service com.alibaba.dubbo.demo.DemoService from url multicast://224.5.6.7:1234/com.alibaba.dubbo.registry.RegistryService?anyhost=true&application=demo-consumer&check=false&dubbo=2.0.0&generic=false&interface=com.alibaba.dubbo.demo.DemoService&methods=sayHello&pid=43363&qos.port=33333&register.ip=192.168.1.116&remote.timestamp=1518918226970&side=consumer&timestamp=1518918323457, dubbo version: 2.0.0, current host: 192.168.1.116
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
Hello world, response form provider: 192.168.1.116:20880
```
