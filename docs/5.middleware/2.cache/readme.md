## 缓存概览

### 缓存原因

      缓存的优点和缺点
      为什么要用缓存？
      用缓存，主要有两个用途：高性能、高并发。

#### 高性能

      假设这么个场景，你有个操作，一个请求过来，吭哧吭哧你各种乱七八糟操作 mysql，半天查出来一个结果，耗时 600ms。但是这个结果可能接下来几个小时都不会变了，或者变了也可以不用立即反馈给用户。那么此时咋办？

      缓存啊，折腾 600ms 查出来的结果，扔缓存里，一个 key 对应一个 value，下次再有人查，别走 mysql 折腾 600ms 了，直接从缓存里，通过一个 key 查出来一个 value，2ms 搞定。性能提升 300 倍。

      就是说对于一些需要复杂操作耗时查出来的结果，且确定后面不怎么变化，但是有很多读请求，那么直接将查询出来的结果放在缓存中，后面直接读缓存就好。

#### 高并发

      mysql 这么重的数据库，压根儿设计不是让你玩儿高并发的，虽然也可以玩儿，但是天然支持不好。mysql 单机支撑到 2000QPS 也开始容易报警了。

      所以要是你有个系统，高峰期一秒钟过来的请求有 1万，那一个 mysql 单机绝对会死掉。你这个时候就只能上缓存，把很多数据放缓存，别放 mysql。缓存功能简单，说白了就是 key-value 式操作，单机支撑的并发量轻松一秒几万十几万，支撑高并发 so easy。单机承载并发量是 mysql 单机的几十倍。

### 基础知识

#### 常用缓存算法

    最不经常使用算法（LFU）：

        这个缓存算法使用一个计数器来记录条目被访问的频率。
        通过使用LFU缓存算法，最低访问数的条目首先被移除。
        这个方法并不经常使用，因为它无法对一个拥有最初高访问率之后长时间没有被访问的条目缓存负责。


    最近最少使用算法（LRU）：

        这个缓存算法将最近使用的条目存放到靠近缓存顶部的位置。
        当一个新条目被访问时，LRU将它放置到缓存的顶部。
        当缓存达到极限时，较早之前访问的条目将从缓存底部开始被移除。这里会使用到昂贵的算法，
        而且它需要记录“年龄位”来精确显示条目是何时被访问的。
        此外，当一个LRU缓存算法删除某个条目后，“年龄位”将随其他条目发生改变。


    自适应缓存替换算法(ARC)：

        在IBM Almaden研究中心开发，这个缓存算法同时跟踪记录LFU和LRU，以及驱逐缓存条目，
        来获得可用缓存的最佳使用。

    先进先出算法（FIFO）：

        FIFO是英文First In First Out 的缩写，是一种先进先出的数据缓存器，
        他与普通存储器的区别是没有外部读写地址线，这样使用起来非常简单，
        但缺点就是只能顺序写入数据，顺序的读出数据，其数据地址由内部读写指针自动加1完成，
        不能像普通存储器那样可以由地址线决定读取或写入某个指定的地址。

    最近最常使用算法（MRU）：

        这个缓存算法最先移除最近最常使用的条目。一个MRU算法擅长处理一个条目越久，越容易被访问的情况。

### 缓存插件

    Ehcache

#### Ehcache

    Ehcache是一种广泛使用的开源Java分布式缓存。主要面向通用缓存,Java EE和轻量级容器。
    它具有内存和磁盘存储，缓存加载器,缓存扩展,缓存异常处理程序,一个gzip缓存servlet过滤器,支持REST和SOAP api等特点。
    Ehcache最初是由Greg Luck于2003年开始开发。2009年,该项目被Terracotta购买。
    软件仍然是开源,但一些新的主要功能(例如，快速可重启性之间的一致性的)只能在商业产品中使用，
    例如Enterprise EHCache and BigMemory。维基媒体Foundationannounced目前使用的就是Ehcache技术。
    主要的特性有：
    1. 快速
    2. 简单
    3. 多种缓存策略
    4. 缓存数据有两级：内存和磁盘，因此无需担心容量问题
    5. 缓存数据会在虚拟机重启的过程中写入磁盘
    6. 可以通过RMI、可插入API等方式进行分布式缓存
    7. 具有缓存和缓存管理器的侦听接口
    8. 支持多缓存管理器实例，以及一个实例的多个缓存区域
    9. 提供Hibernate的缓存实现

### 内存数据库

    Redis/Memcache

#### Redis

    REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。

    Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。

    它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Hash), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。

#### Memcache

memcache 是一个高性能的分布式的内存对象缓存系统，用于动态 Web 应用以减轻数据库负担。它通过在内存中缓存数据和对象，来减少读取数据库的次数。从而提高动态、数据库驱动网站速度。

memcache 通过在内存里维护一个统一的巨大的 hash 表，它能够用来存储各种格式的数据，包括图像、视频、文件以及数据库检索的结果等。memcache 主要用于分担数据库负的压力，memcache 将数据调用到内存中，然后从内存中读取，从而大大提高读取速度

参考：
