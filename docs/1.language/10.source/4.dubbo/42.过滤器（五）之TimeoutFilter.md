# è¿‡æ»¤å™¨ï¼ˆäº”ï¼‰ä¹‹ TimeoutFilter

æœ¬æ–‡åŸºäº Dubbo 2.6.1 ç‰ˆæœ¬ï¼Œæœ›çŸ¥æ‚‰ã€‚

# 1. æ¦‚è¿°

æœ¬æ–‡åˆ†äº«è¿‡æ»¤å™¨ TimeoutFilter ï¼Œç”¨äºæœåŠ¡**æä¾›è€…**ä¸­ã€‚

# 2. TimeoutFilter

com.alibaba.dubbo.rpc.filter.TimeoutFilter
ï¼Œå®ç° Filter æ¥å£ï¼Œè¶…æ—¶è¿‡æ»¤å™¨ã€‚å¦‚æœæœåŠ¡è°ƒç”¨**è¶…æ—¶**ï¼Œè®°å½•**å‘Šè­¦**æ—¥å¿—ï¼Œ**ä¸å¹²æ¶‰**æœåŠ¡çš„è¿è¡Œã€‚ä»£ç å¦‚ä¸‹ï¼š

```
1: @Activate(group = Constants.PROVIDER)
2: public class TimeoutFilter implements Filter{
3:
4: private static final Logger logger = LoggerFactory.getLogger(TimeoutFilter.class);
5:
6: @Override
7: public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException{
8: long start = System.currentTimeMillis();
9: // æœåŠ¡è°ƒç”¨
10: Result result = invoker.invoke(invocation);
11: // è®¡ç®—è°ƒç”¨æ—¶é•¿
12: long elapsed = System.currentTimeMillis() - start;
13: // è¶…è¿‡æ—¶é•¿ï¼Œæ‰“å°å‘Šè­¦æ—¥å¿—
14: if (invoker.getUrl() != null
15: && elapsed > invoker.getUrl().getMethodParameter(invocation.getMethodName(), "timeout", Integer.MAX_VALUE)) {
16: if (logger.isWarnEnabled()) {
17: logger.warn("invoke time out. method: " + invocation.getMethodName()
18: + " arguments: " + Arrays.toString(invocation.getArguments()) + " , url is "
19: + invoker.getUrl() + ", invoke elapsed " + elapsed + " ms.");
20: }
21: }
22: return result;
23: }
24:
25: }
```

- ç¬¬ 10 è¡Œï¼šè°ƒç”¨

Invoker/#invoke(invocation)
æ–¹æ³•ï¼ŒæœåŠ¡è°ƒç”¨ã€‚

- ç¬¬ 12 è¡Œï¼šè®¡ç®—è°ƒç”¨æ—¶é•¿ã€‚
- ç¬¬ 13 è‡³ 21 è¡Œï¼šè¶…è¿‡æ—¶é•¿ï¼Œæ‰“å°**å‘Šè­¦**æ—¥å¿—ã€‚æ³¨æ„ï¼Œæ­¤å¤„çš„

"timeout"
å–å¾—çš„æ˜¯æœåŠ¡**æä¾›è€…**çš„é…ç½®ï¼Œä¸åŒäºæœåŠ¡**æ¶ˆè´¹è€…**çš„é…ç½®ã€‚

- ç¬¬ 22 è¡Œï¼šè¿”å›è°ƒç”¨ç»“æœã€‚
- ğŸ™‚ å†æ³¨æ„ï¼Œåœ¨æœåŠ¡**æä¾›è€…**ï¼Œæ‰§è¡ŒæœåŠ¡è°ƒç”¨æ—¶ï¼Œå³ä½¿**è¶…è¿‡äº†è¶…æ—¶æ—¶é—´**ï¼Œä¹Ÿä¸ä¼šå–æ¶ˆæ‰§è¡Œã€‚è™½ç„¶ï¼ŒæœåŠ¡**æ¶ˆè´¹è€…**ï¼Œå·²ç»ç»“æŸè°ƒç”¨ï¼Œè¿”å›è°ƒç”¨è¶…æ—¶ã€‚
